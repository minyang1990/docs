# 分享一下我的开源项目技术架构以及成就：被阮一峰博客推荐，一天涨了100多star - 开发调优 - LINUX DO
[分享一下我的开源项目技术架构以及成就：被阮一峰博客推荐，一天涨了100多star - 开发调优 - LINUX DO](https://linux.do/t/topic/798737) 

  分享一下我的开源项目技术架构以及成就：被阮一峰博客推荐，一天涨了100多star - 开发调优 - LINUX DO                                              

[跳到主要内容](#main-container)

 [![](https://linux.do/uploads/default/original/3X/9/d/9dd49731091ce8656e94433a26a3ef36062b3994.png)](/) 

[分享一下我的开源项目技术架构以及成就：被阮一峰博客推荐，一天涨了100多star](/t/topic/798737)
===========================================================

[开发调优](/c/develop/4)

[软件开发](/tag/软件开发)

*   ​

*    ![](https://linux.do/letter_avatar/niyan2025/96/5_d44a9b381edc88181525e3c8350177ca.png)
       [ 2 ](# "2 个未读通知") 

*   [话题](/latest "所有话题")
*   [我的帖子](/u/niyan2025/activity/drafts "我的未发布草稿")
*   [我的消息](/u/niyan2025/messages "我的个人信息")
*   [关于](/about "关于此网站的更多详细信息")
*   [即将到来的活动](/upcoming-events "即将到来的活动")
*   更多

外部链接

*   [2048](https://2048.linux.do)
*   [Status](https://status.linux.do)
*   [T-Shirt](https://shanwaiyoushan.taobao.com)
*   [Connect](https://connect.linux.do)
*   [Webmail](https://webmail.linux.do)
*   [Channel](https://t.me/linux_do_channel)
*   [Telegram](https://t.me/ja_netfilter_group)

类别

*   [开发调优](/c/develop/4 "此版块包含开发、测试、调试、部署、优化、安全等方面的内容")
*   [资源荟萃](/c/resource/14 "包括软件分享、开源仓库、视频课程、书籍等分享")
*   [文档共建](/c/wiki/42 "佬友化身翰林学士，一起来编书了。")
*   [非我莫属](/c/job/27 "学成文武艺，货与帝王家。招聘/求职分类，只能发此类信息。")
*   [读书成诗](/c/reading/32 "跟着佬友们一起在论坛读完一本书是什么体验？")
*   [扬帆起航](/c/startup/46 "扬帆起航，目标是星辰大海！")
*   [前沿快讯](/c/news/34 "前沿快讯，不出门能知天下事。")
*   [网络记忆](/c/feeds/92 "网络是有记忆的，确信！")
*   [福利羊毛](/c/welfare/36 "正经人谁花那个钱啊～ 此版块供羊毛、抽奖等福利使用。")
*   [搞七捻三](/c/gossip/11 "闲聊吹水的板块。不得讨论政治、色情等违规内容。")
*   [运营反馈](/c/feedback/2 "有关此站点、其组织、运作方式以及如何改进的讨论。")
*   [深海幽域](/c/muted/45 "冰山下的深海。帖子不会上信息流、不会被论坛搜索。")
*   [所有类别](/categories)

标签

*   [人工智能](/tag/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD)
*   [公告](/tag/%E5%85%AC%E5%91%8A)
*   [快问快答](/tag/%E5%BF%AB%E9%97%AE%E5%BF%AB%E7%AD%94)
*   [抽奖](/tag/%E6%8A%BD%E5%A5%96)
*   [精华神帖](/tag/%E7%B2%BE%E5%8D%8E%E7%A5%9E%E5%B8%96)
*   [所有标签](/tags)

*   [我的消息串](/chat/threads "我的消息串")

频道

*   [常规频道](/chat/c/general/2 "🈲 禁止在聊天频道里发送 打卡 等无意义信息，被举报会喜提 禁言1小时 。")

直接消息

*    [![](https://linux.do/user_avatar/linux.do/xronus/48/130867_2.png)  𝒜𝓃𝒾𝓋𝒾𝓍](/chat/c/%F0%9D%92%9C%F0%9D%93%83%F0%9D%92%BE%F0%9D%93%8B%F0%9D%92%BE%F0%9D%93%8D/32458 "与 𝒜𝓃𝒾𝓋𝒾𝓍 聊天") 
*    [![](https://linux.do/user_avatar/linux.do/huan/48/293194_2.png)  焕昭君](/chat/c/%E7%84%95%E6%98%AD%E5%90%9B/43057 "与 焕昭君 聊天") 
*    [![](https://linux.do/user_avatar/linux.do/wenjuhe/48/672301_2.png)  奇妙进化小河马🦛   ![](https://linux.do/images/emoji/twemoji/hippopotamus.png?v=14)](/chat/c/%E5%A5%87%E5%A6%99%E8%BF%9B%E5%8C%96%E5%B0%8F%E6%B2%B3%E9%A9%AC%F0%9F%A6%9B/45968 "与 奇妙进化小河马🦛 聊天") 

聊天

Default

​ ​ ​

**真诚**、**友善**、**团结**、**专业**，共建你我引以为荣之社区。[《常见问题解答》](/faq)

[分享一下我的开源项目技术架构以及成就：被阮一峰博客推荐，一天涨了100多star](/t/topic/798737)
===========================================================

[开发调优](/c/develop/4)

[软件开发](/tag/软件开发)

您已选择 **0** 个帖子。

全选

取消选择

​

[7月 18 日](/t/topic/798737/1 "跳到第一个帖子")

1 / 30

7月 17 日

[16 小时 前](/t/topic/798737/30)

​

[![](https://linux.do/user_avatar/linux.do/sou/96/364843_2.png)
](/u/sou)

[爱折腾的sky](/u/sou)[sou](/u/sou)

5

[19 小时](/t/topic/798737?u=niyan2025 "发布日期")

阮一峰博客地址：[https://www.ruanyifeng.com/blog/2025/07/weekly-issue-357.html](https://www.ruanyifeng.com/blog/2025/07/weekly-issue-357.html)

我的项目地址：[GitHub - sky22333/hubproxy: 基于Go的自托管轻量级、高性能的多功能代理加速服务，提供 Docker 镜像加速、GitHub 加速、下载离线镜像等功能。单域名实现所有功能，支持仓库审计。流式转发，无缓存。](https://github.com/sky22333/hubproxy)

这是一个go实现的，轻量级、高性能的多功能代理服务，提供 Docker 镜像加速、GitHub 文件加速、下载离线镜像、在线搜索 Docker 镜像等功能。创建此项目的初衷是目前各大镜像站都比较单一不够方便，此项目解决了集各种镜像加速于一体，单个二进制文件，所有代理都在统一的入口，方便垃圾小鸡部署。并且自托管的好处就是不依赖cf等等不稳定的网络

#### [](#p-7325816-h-1)![](https://linux.do/images/emoji/twemoji/sparkles.png?v=14)
 特性

*   ![](https://linux.do/images/emoji/twemoji/spouting_whale.png?v=14)
     **Docker 镜像加速** - 单域名实现 Docker Hub、GHCR、Quay 等多个镜像仓库加速，流式传输优化拉取速度。
*   ![](https://linux.do/images/emoji/twemoji/spouting_whale.png?v=14)
     **离线镜像包** - 支持下载离线镜像包，流式传输加防抖设计。
*   ![](https://linux.do/images/emoji/twemoji/file_folder.png?v=14)
     **GitHub 文件加速** - 加速 GitHub Release、Raw 文件下载，支持`api.github.com`，脚本嵌套加速等等
*   ![](https://linux.do/images/emoji/twemoji/robot.png?v=14)
     **AI 模型库支持** - 支持 Hugging Face 模型下载加速
*   ![](https://linux.do/images/emoji/twemoji/shield.png?v=14)
     **智能限流** - IP 限流保护，防止滥用
*   ![](https://linux.do/images/emoji/twemoji/prohibited.png?v=14)
     **仓库审计** - 强大的自定义黑名单，白名单，同时审计镜像仓库，和GitHub仓库
*   ![](https://linux.do/images/emoji/twemoji/magnifying_glass_tilted_left.png?v=14)
     **镜像搜索** - 在线搜索 Docker 镜像
*   ![](https://linux.do/images/emoji/twemoji/high_voltage.png?v=14)
     **轻量高效** - 基于 Go 语言，单二进制文件运行，资源占用低，优雅的内存清理机制。
*   ![](https://linux.do/images/emoji/twemoji/wrench.png?v=14)
     **统一配置** - 统一配置管理

从完全重构开源，一个月时间从0 star到截至目前一共收获了562 star。当然也有很多佬友的支持，目前项目已经算是比较稳定了，部署在优质线路机器上，从国内拉取代理镜像可以做到无墙一样。

[](#p-7325816-h-2)关于设计思路
------------------------

### [](#p-7325816-h-3)镜像加速

之前我使用直接用的官方registry做镜像加速，但是我发现一个问题，就是从docker pull到出现下载进度条会有很长的延迟，原因在于官方的registry每次都会去docker hub请求匿名token和寻找镜像清单，并且代理转发到客户端时会将镜像缓存到机器，我的实现跟官方registry部署方法相比的优势是，不会缓存镜像到机器中，并且优化了匿名token和镜像清单做了缓存，减少了重复认证的请求耗时，然后流式转发到客户端，所以能尽量做到最快。这里跟上游仓库的接口交互，是直接复用了google的docker库部分组件。接口很通用。

### [](#p-7325816-h-4)离线镜像下载

关于在线下载离线镜像的逻辑，之前用了及其笨的方法，是让先让代理机器拉取镜像，然后自动打包为tar文件，然后开放一个文件接口供用户下载，这种方法速度特别慢，后来经过摸索优化，现在是直接请求docker仓库镜像的文件层数据，然后流式转发到客户端，边下载变压缩为tar离线文件，速度相当于直接拉取镜像的速度，连打包tar文件的时间都省了。

### [](#p-7325816-github-5)github文件加速

关于github文件加速的逻辑是直接借鉴了网上开源的github文件加速的思路，然后重构为go实现。这里非常感谢这些大佬。

### [](#p-7325816-h-6)中间件

然后主入口加了一些IP限流中间件，黑名单中间件等等，防止被拉爆。前端则是直接让AI写的。直接调用后端接口。  
项目总体实现没啥问题，就是我比较菜，写的不够优雅，优化空间还很大。

### [](#p-7325816-h-7)关于速度

我在cn2的美国机器上部署，国内机器拉192MB的nginx镜像用时15秒，如果用HK优质线路机器的话还能更快，如图：

[![](https://linux.do/uploads/default/optimized/4X/e/5/2/e52dc20a6ac1289d579c76efc50e4f7b0274eaa7_2_690x422.png)

image1310×802 89.6 KB

](https://linux.do/uploads/default/original/4X/e/5/2/e52dc20a6ac1289d579c76efc50e4f7b0274eaa7.png "image")

### [](#p-7325816-h-8)关于性能占用和稳定性

然后我github上的demo镜像站是用的wap.ac的1H1G的2刀机器，带宽1000M。并且做了性能监控。  
这个监控是随便写的一个go程序：[go-utils/jiankong at main · sky22333/go-utils · GitHub](https://github.com/sky22333/go-utils/tree/main/jiankong)

demo站镜像地址：[https://demo.52013120.xyz](https://demo.52013120.xyz) 大家可以随便拉，就当帮我测试稳定性了

基本上每天都有人在拉镜像，而且我看日志每天都有人在拉几个G的大镜像，稳定运行了22天，无崩溃，无内存飙升，无重启。流量差不多干了2600 GB，程序很轻量，也有自动回收内存和缓存等等，占用很低，如图：  

[![](https://linux.do/uploads/default/optimized/4X/e/b/7/eb7a90c23b39bdaa2baae94ea9d3b017838bac40_2_597x499.jpeg)

image1157×968 85.8 KB

](https://linux.do/uploads/default/original/4X/e/b/7/eb7a90c23b39bdaa2baae94ea9d3b017838bac40.jpeg "image")

[![](https://linux.do/uploads/default/optimized/4X/f/5/9/f59bc9984c846c86cc6f196ae2f247656f1b9430_2_690x269.png)

image1112×435 33.8 KB

](https://linux.do/uploads/default/original/4X/f/5/9/f59bc9984c846c86cc6f196ae2f247656f1b9430.png "image")

  

1 个回复

![](https://linux.do/images/emoji/twemoji/heart.png?v=14)

heart

![](https://linux.do/images/emoji/twemoji/+1.png?v=14)

+1

![](https://linux.do/images/emoji/twemoji/clap.png?v=14)

clap

40

​ ​ 回复

689 浏览量 40 赞 5 链接 22 用户

 [![](https://linux.do/user_avatar/linux.do/sou/96/364843_2.png)
 7](/u/sou "sou") 

 [![](https://linux.do/user_avatar/linux.do/siren/96/768166_2.png)
 2](/u/siren "siren") 

 [![](https://linux.do/user_avatar/linux.do/qcwd/96/24464_2.png)
 2](/u/qcwd "qcwd") 

 [![](https://linux.do/letter_avatar/aveng/96/5_d44a9b381edc88181525e3c8350177ca.png)](/u/aveng "aveng") 

 [![](https://linux.do/user_avatar/linux.do/yuke/96/934_2.png)](/u/yuke "yuke") 

[![](https://linux.do/user_avatar/linux.do/hiraly/96/305713_2.png)
](/u/hiraly)

[hiraly](/u/hiraly)

[19 小时](/t/topic/798737/2?u=niyan2025 "发布日期")

大佬，手下我的膝盖。

  

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/bosa/96/757996_2.png)
](/u/Bosa)

[BosaBosa](/u/Bosa)[Bosa](/u/Bosa)

[19 小时](/t/topic/798737/3?u=niyan2025 "发布日期")

太强啦佬

  

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/sage_silver/96/320260_2.png)
](/u/Sage_Silver)

[Sage\_Silver](/u/Sage_Silver)

[19 小时](/t/topic/798737/4?u=niyan2025 "发布日期")

大佬恐怖如斯，学习了。

  

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/yqyan/96/576335_2.png)
](/u/yqyan)

[Grogu](/u/yqyan)[yqyan](/u/yqyan)

[19 小时](/t/topic/798737/5?u=niyan2025 "发布日期")

佬友太强了 ![](https://linux.do/images/emoji/twemoji/+1.png?v=14)
，恭喜佬友 ![](https://linux.do/images/emoji/twemoji/tada.png?v=14)

  

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/code0/96/102509_2.png)
](/u/code0)

[code0](/u/code0)浴火重生 ![](https://linux.do/images/emoji/twemoji/cn.png?v=14) 

[19 小时](/t/topic/798737/6?u=niyan2025 "发布日期")

![](https://linux.do/user_avatar/linux.do/sou/48/364843_2.png)
 爱折腾的sky:

> 性能监控

大佬，这个怎么做？想学习一下。

  

1 个回复

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/sou/96/364843_2.png)
](/u/sou)

[爱折腾的sky](/u/sou)[sou](/u/sou)

 ![](https://linux.do/user_avatar/linux.do/code0/48/102509_2.png)
 code0

[19 小时](/t/topic/798737/7?u=niyan2025 "发布日期")

随便写的一个监控：[go-utils/jiankong at main · sky22333/go-utils · GitHub](https://github.com/sky22333/go-utils/tree/main/jiankong)

  

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/rua/96/598095_2.png)
](/u/Rua)

[Rua](/u/Rua)种子用户 ![](https://linux.do/images/emoji/twemoji/speech_balloon.png?v=14) 

[19 小时](/t/topic/798737/8?u=niyan2025 "发布日期")

用了挺久了，很好用，感谢大佬

  

1 个回复

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/sou/96/364843_2.png)
](/u/sou)

[爱折腾的sky](/u/sou)[sou](/u/sou)

 ![](https://linux.do/user_avatar/linux.do/rua/48/598095_2.png)
 Rua

[19 小时](/t/topic/798737/9?u=niyan2025 "发布日期")

感谢大佬的认可

  

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/momo521/96/686253_2.png)
](/u/momo521)

[momo521](/u/momo521)

[19 小时](/t/topic/798737/10?u=niyan2025 "发布日期")

![](https://linux.do/images/emoji/twemoji/+1.png?v=14)
 ![](https://linux.do/images/emoji/twemoji/+1.png?v=14)

  

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/handsome/96/736205_2.png)
](/u/handsome)

[大帅哥](/u/handsome)[handsome](/u/handsome)种子用户 ![](https://linux.do/images/emoji/twemoji/rage.png?v=14) 

[19 小时](/t/topic/798737/11?u=niyan2025 "发布日期")

感谢大佬 。

  

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/qcwd/96/24464_2.png)
](/u/qcwd)

[qcwd](/u/qcwd)一元复始 ![](https://linux.do/images/emoji/twemoji/unicorn.png?v=14) 

[19 小时](/t/topic/798737/12?u=niyan2025 "发布日期")

大佬项目特别优秀，我之前帖子也是用的大佬项目构建的。

![](https://linux.do/user_avatar/linux.do/qcwd/48/24464_2.png)
 [【彻底解决】一个小项目，助你彻底解决github,docker镜像下载拉取问题](https://linux.do/t/topic/759268) [资源荟萃](/c/resource/14)

> 项目地址：[znb/hubproxy · Cloud Native Build](https://cnb.cool/znb/hubproxy) 运行原理：借助CNB的加速能力，快速起一个自用的github, dockerhub下载加速站，即开即用，用过的都说好。

  

1 个回复

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/sou/96/364843_2.png)
](/u/sou)

[爱折腾的sky](/u/sou)[sou](/u/sou)

 ![](https://linux.do/user_avatar/linux.do/qcwd/48/24464_2.png)
 qcwd

[19 小时](/t/topic/798737/13?u=niyan2025 "发布日期")

感谢大佬的认可，其实代码写的比较烂，我感觉还是不够优雅，本着能用就别动的原则，我也就懒得优化了，哈哈

  

1 个回复

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/qcwd/96/24464_2.png)
](/u/qcwd)

[qcwd](/u/qcwd)一元复始 ![](https://linux.do/images/emoji/twemoji/unicorn.png?v=14) 

 ![](https://linux.do/user_avatar/linux.do/sou/48/364843_2.png)
 爱折腾的sky

[19 小时](/t/topic/798737/14?u=niyan2025 "发布日期")

主要是解决的场景恰到好处，够用就好。

  

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/rede/96/724216_2.png)
](/u/rede)

[红林](/u/rede)[rede](/u/rede)

[18 小时](/t/topic/798737/15?u=niyan2025 "发布日期")

膜拜一下 大佬

  

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/nerokim/96/114173_2.png)
](/u/nerokim)

[🍏네로🍎](/u/nerokim)[nerokim](/u/nerokim)

[18 小时](/t/topic/798737/16?u=niyan2025 "发布日期")

感谢分享，已Star ![](https://linux.do/images/emoji/twemoji/hand_with_index_finger_and_thumb_crossed.png?v=14)

  

​ ​ 回复

[![](https://linux.do/letter_avatar/taimengsu/96/5_d44a9b381edc88181525e3c8350177ca.png)
](/u/taimengsu)

[taimengsu](/u/taimengsu)

[18 小时](/t/topic/798737/17?u=niyan2025 "发布日期")

大佬优秀

  

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/break/96/71453_2.png)
](/u/break)

[break](/u/break)

[18 小时](/t/topic/798737/18?u=niyan2025 "发布日期")

赞赞 ![](https://linux.do/uploads/default/original/3X/7/d/7d5173acb48b6662934d93d15ccf03bc4eb4fe1e.png?v=14)

  

​ ​ 回复

[![](https://linux.do/letter_avatar/yelixin_117/96/5_d44a9b381edc88181525e3c8350177ca.png)
](/u/yelixin_117)

[yelixin\_117](/u/yelixin_117)

[18 小时](/t/topic/798737/19?u=niyan2025 "发布日期")

给大佬点个star，yysy，非常实用。

  

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/vcig/96/734062_2.png)
](/u/vcig)

[vcig](/u/vcig)

[18 小时](/t/topic/798737/20?u=niyan2025 "发布日期")

今天刚在阮一峰周刊刷到，没想到大佬就在L站，太强了！

  

​ ​ 回复

Invalid date Invalid date

↑↓⇔⇧⇩