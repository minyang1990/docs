# windows通过cmd和git bash使用Claude code（发现还是有兼容性问题...） - 搞七捻三 - LINUX DO
[windows通过cmd和git bash使用Claude code（发现还是有兼容性问题...） - 搞七捻三 - LINUX DO](https://linux.do/t/topic/726007) 

  windows通过cmd和git bash使用Claude code（发现还是有兼容性问题...） - 搞七捻三 - LINUX DO                                                

[跳到主要内容](#main-container)

 [![](https://linux.do/uploads/default/original/3X/9/d/9dd49731091ce8656e94433a26a3ef36062b3994.png)](/) 

[windows通过cmd和git bash使用Claude code（发现还是有兼容性问题…）](/t/topic/726007)
==================================================================

[搞七捻三](/c/gossip/11)

[纯水](/tag/纯水),[人工智能](/tag/人工智能),[软件开发](/tag/软件开发)

*   ​

*    ![](https://linux.do/letter_avatar/niyan2025/96/5_d44a9b381edc88181525e3c8350177ca.png)
       [ 2 ](# "2 个未读通知") 

*   [话题](/latest "所有话题")
*   [我的帖子](/u/niyan2025/activity/drafts "我的未发布草稿")
*   [My Messages](/my/messages)
*   [关于](/about "关于此网站的更多详细信息")
*   [即将到来的活动](/upcoming-events "即将到来的活动")
*   更多

外部链接

*   [2048](https://2048.linux.do)
*   [Status](https://status.linux.do)
*   [T-Shirt](https://shanwaiyoushan.taobao.com)
*   [Connect](https://connect.linux.do)
*   [Webmail](https://webmail.linux.do)
*   [Channel](https://t.me/linux_do_channel)
*   [Telegram](https://t.me/ja_netfilter_group)

类别

*   [开发调优](/c/develop/4 "此版块包含开发、测试、调试、部署、优化、安全等方面的内容")
*   [资源荟萃](/c/resource/14 "包括软件分享、开源仓库、视频课程、书籍等分享")
*   [文档共建](/c/wiki/42 "佬友化身翰林学士，一起来编书了。")
*   [非我莫属](/c/job/27 "学成文武艺，货与帝王家。招聘/求职分类，只能发此类信息。")
*   [读书成诗](/c/reading/32 "跟着佬友们一起在论坛读完一本书是什么体验？")
*   [扬帆起航](/c/startup/46 "扬帆起航，目标是星辰大海！")
*   [前沿快讯](/c/news/34 "前沿快讯，不出门能知天下事。")
*   [网络记忆](/c/feeds/92 "网络是有记忆的，确信！")
*   [福利羊毛](/c/welfare/36 "正经人谁花那个钱啊～ 此版块供羊毛、抽奖等福利使用。")
*   [搞七捻三](/c/gossip/11 "闲聊吹水的板块。不得讨论政治、色情等违规内容。")
*   [运营反馈](/c/feedback/2 "有关此站点、其组织、运作方式以及如何改进的讨论。")
*   [深海幽域](/c/muted/45 "冰山下的深海。帖子不会上信息流、不会被论坛搜索。")
*   [所有类别](/categories)

标签

*   [人工智能](/tag/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD)
*   [公告](/tag/%E5%85%AC%E5%91%8A)
*   [快问快答](/tag/%E5%BF%AB%E9%97%AE%E5%BF%AB%E7%AD%94)
*   [抽奖](/tag/%E6%8A%BD%E5%A5%96)
*   [精华神帖](/tag/%E7%B2%BE%E5%8D%8E%E7%A5%9E%E5%B8%96)
*   [所有标签](/tags)

*   [我的消息串](/chat/threads "我的消息串")

频道

*   [常规频道](/chat/c/general/2 "🈲 禁止在聊天频道里发送 打卡 等无意义信息，被举报会喜提 禁言1小时 。")

直接消息

*    [![](https://linux.do/user_avatar/linux.do/xronus/48/130867_2.png)  𝒜𝓃𝒾𝓋𝒾𝓍](/chat/c/%F0%9D%92%9C%F0%9D%93%83%F0%9D%92%BE%F0%9D%93%8B%F0%9D%92%BE%F0%9D%93%8D/32458 "与 𝒜𝓃𝒾𝓋𝒾𝓍 聊天") 
*    [![](https://linux.do/user_avatar/linux.do/huan/48/293194_2.png)  焕昭君](/chat/c/%E7%84%95%E6%98%AD%E5%90%9B/43057 "与 焕昭君 聊天") 
*    [![](https://linux.do/user_avatar/linux.do/wenjuhe/48/672301_2.png)  奇妙进化小河马🦛   ![](https://linux.do/images/emoji/twemoji/hippopotamus.png?v=14)](/chat/c/%E5%A5%87%E5%A6%99%E8%BF%9B%E5%8C%96%E5%B0%8F%E6%B2%B3%E9%A9%AC%F0%9F%A6%9B/45968 "与 奇妙进化小河马🦛 聊天") 

聊天

Default

​ ​ ​

**真诚**、**友善**、**团结**、**专业**，共建你我引以为荣之社区。[《常见问题解答》](/faq)

[

❤️ 再忍不住，也不要做这种事啊 ❤️

](https://linux.do/t/topic/482293)

[windows通过cmd和git bash使用Claude code（发现还是有兼容性问题…）](/t/topic/726007)
==================================================================

[搞七捻三](/c/gossip/11)

[纯水](/tag/纯水),[人工智能](/tag/人工智能),[软件开发](/tag/软件开发)

您已选择 **0** 个帖子。

全选

取消选择

​

[6月 16 日](/t/topic/726007/1 "跳到第一个帖子")

1 / 32

6月 16 日

[5 分钟](/t/topic/726007/32)

​

[![](https://linux.do/user_avatar/linux.do/xieyang/96/749837_2.png)
](/u/xieyang)

[Mras](/u/xieyang)[xieyang](/u/xieyang)活跃用户

2

[18 天](/t/topic/726007?u=niyan2025 "发布日期")

[](#p-6642318-claude-code-windows-1)Claude Code 在 Windows 环境下的一种安装方案
====================================================================

[](#p-6642318-h-2)问题背景
----------------------

昨天看到论坛佬友通过 [这个帖子](https://linux.do/t/topic/719181) 分享的方式使用 Claude Code，于是在家里的 Windows 电脑上尝试安装。通过 PowerShell 安装后，每次启动时都会遇到这个令人头疼的错误：

```


`This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). The promise rejected with the reason:
Error: No suitable shell found. Claude CLI requires a Posix shell environment. Please ensure you have a valid shell installed and the SHELL environment variable set.` 
```

对于有强迫症的朋友来说，这个错误提示实在太不爽了！经过一番摸索，终于找到了一种解决方案。

[](#p-6642318-h-3)解决方案
----------------------

今天在公司测试发现，通过CMD配置环境变量的方式可以解决这个问题。以下是详细的安装步骤：

### [](#p-6642318-cmd-4)步骤一：打开 cmd

```


`以管理员权限打开cmd` 
```

### [](#p-6642318-npm-npm-preinstallpostinstall-cmd-5)步骤二：设置 NPM 配置,告诉 npm 在安装包时忽略执行包中的脚本（如 preinstall、postinstall 等）,设置完重新启动CMD

```


`setx NPM_CONFIG_IGNORE_SCRIPTS true` 
```

### [](#p-6642318-shell-6)步骤三：配置 SHELL 环境变量

```


`setx SHELL "C:\Program Files\Git\bin\bash.exe"` 
```

### [](#p-6642318-claude-code-7)步骤四：安装 Claude Code

```


`npm install -g @anthropic-ai/claude-code` 
```

### [](#p-6642318-h-8)步骤五：添加环境变量

```


`在环境变量中添加这一句：C:\Users\y.xie\.npm-global` 
```

### [](#p-6642318-h-9)步骤六：重启开发环境

重启 CMD 或者重启 IDE（如 VS Code、IntelliJ IDEA 等），然后在其中直接登录 Claude Code 相关账户或配置 API 即可正常使用。

[](#p-6642318-h-10)补充说明
-----------------------

*   确保已安装 Git for Windows，路径为 `C:\Program Files\Git\bin\bash.exe`
*   如果 Git 安装路径不同，请相应调整 SHELL 环境变量的路径
*   C:\\Users\\y.xie.npm-global这个路径也请根据实际路径添加
*   建议使用永久设置方式，避免每次重启后重新配置
*   后面佬友如果不想安装了，想将步骤二与步骤三恢复，执行setx NPM\_CONFIG\_IGNORE\_SCRIPTS false与setx SHELL ""就好了

通过以上步骤，就可以在 Windows 环境下使用 Claude Code，再也不会看到那个烦人的错误提示了！

[](#p-6642318-wslwsl-11)至于我为什么没有选择WSL方式，因为公司电脑安装了加密软件，与WSL系统隔离了,读取不了加密文件。
-------------------------------------------------------------------------

**感兴趣的朋友们可以试试这个方法，希望对大家有帮助！** ![](https://linux.do/images/emoji/twemoji/tada.png?v=14)
  

[![](https://linux.do/uploads/default/optimized/4X/2/8/0/28019d091f6d4902afc4fdc0c8407a5cf5a7d773_2_690x427.png)

image926×574 37.9 KB

](https://linux.do/uploads/default/original/4X/2/8/0/28019d091f6d4902afc4fdc0c8407a5cf5a7d773.png "image")

[![](https://linux.do/uploads/default/original/4X/c/f/d/cfd20db0fe66b00266aa13f77778bcc804c2f20c.png)

image1375×685 14.1 KB

](https://linux.do/uploads/default/original/4X/c/f/d/cfd20db0fe66b00266aa13f77778bcc804c2f20c.png "image")

  

1 个回复

![](https://linux.do/images/emoji/twemoji/heart.png?v=14)

heart

![](https://linux.do/images/emoji/twemoji/+1.png?v=14)

+1

11

​ ​ 回复

787 浏览量 21 赞 4 链接 13 用户

 [![](https://linux.do/user_avatar/linux.do/xieyang/96/749837_2.png)
 11](/u/xieyang "xieyang")

 [![](https://linux.do/letter_avatar/renyi/96/5_d44a9b381edc88181525e3c8350177ca.png)
 5](/u/renyi "renyi") 

 [![](https://linux.do/user_avatar/linux.do/a186232641/96/229054_2.png)
 3](/u/a186232641 "a186232641") 

 [![](https://linux.do/user_avatar/linux.do/dext7r/96/227697_2.png)
 3](/u/dext7r "dext7r")

 [![](https://linux.do/letter_avatar/xiangaodielian/96/5_d44a9b381edc88181525e3c8350177ca.png)
 2](/u/xiangaodielian "xiangaodielian")

[![](https://linux.do/user_avatar/linux.do/throttle/96/778052_2.png)
](/u/Throttle)

[方块](/u/Throttle)[Throttle](/u/Throttle)无所不知

[18 天](/t/topic/726007/2?u=niyan2025 "发布日期")

感谢分享，好人一胎十个

  

![](https://linux.do/images/emoji/twemoji/heart.png?v=14)

heart

![](https://linux.do/images/emoji/twemoji/laughing.png?v=14)

laughing

2

​ ​ 回复

[![](https://linux.do/letter_avatar/xiangaodielian/96/5_d44a9b381edc88181525e3c8350177ca.png)
](/u/xiangaodielian)

[金坷垃](/u/xiangaodielian)[xiangaodielian](/u/xiangaodielian)活跃用户

[18 天](/t/topic/726007/3?u=niyan2025 "发布日期")

感谢分享， 刚刚试了  
npm error Error: Claude Code is not supported on Windows.  
卡在安装cc这步

  

1 个回复

2

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/xieyang/96/749837_2.png)
](/u/xieyang)

[Mras](/u/xieyang)[xieyang](/u/xieyang)活跃用户

 ![](https://linux.do/letter_avatar/xiangaodielian/48/5_d44a9b381edc88181525e3c8350177ca.png)
 金坷垃

[18 天](/t/topic/726007/4?u=niyan2025 "发布日期")

![](https://linux.do/letter_avatar/xiangaodielian/48/5_d44a9b381edc88181525e3c8350177ca.png)
 金坷垃:

> e is not supported on Windows.

不会吧，按理说第二步输入这个命令就可以安装了啊

  

1 个回复

1

​ ​ 回复

[![](https://linux.do/letter_avatar/xiangaodielian/96/5_d44a9b381edc88181525e3c8350177ca.png)
](/u/xiangaodielian)

[金坷垃](/u/xiangaodielian)[xiangaodielian](/u/xiangaodielian)活跃用户

 ![](https://linux.do/user_avatar/linux.do/xieyang/48/749837_2.png)
 Mras

[18 天](/t/topic/726007/5?u=niyan2025 "发布日期")

重启cmd可以了 ![](https://linux.do/images/emoji/twemoji/monkey.png?v=14)

  

1 个回复

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/xieyang/96/749837_2.png)
](/u/xieyang)

[Mras](/u/xieyang)[xieyang](/u/xieyang)活跃用户

 ![](https://linux.do/letter_avatar/xiangaodielian/48/5_d44a9b381edc88181525e3c8350177ca.png)
 金坷垃

[18 天](/t/topic/726007/6?u=niyan2025 "发布日期")

应该是第二步还有一个命令我没有加进去，主要是昨天参考的论坛佬友的，我补上去看看 ![](https://linux.do/images/emoji/twemoji/joy.png?v=14)

  

1

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/handsome/96/736205_2.png)
](/u/handsome)

[大帅哥](/u/handsome)[handsome](/u/handsome)种子用户 ![](https://linux.do/images/emoji/twemoji/rage.png?v=14) 

[18 天](/t/topic/726007/7?u=niyan2025 "发布日期")

感谢大佬！

  

1 个回复

​ ​ 回复

[![](https://linux.do/letter_avatar/renyi/96/5_d44a9b381edc88181525e3c8350177ca.png)
](/u/renyi)

[任意](/u/renyi)[renyi](/u/renyi)

[18 天](/t/topic/726007/8?u=niyan2025 "发布日期")

MCP啥的能正常用吗

  

1 个回复

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/xieyang/96/749837_2.png)
](/u/xieyang)

[Mras](/u/xieyang)[xieyang](/u/xieyang)活跃用户

 ![](https://linux.do/letter_avatar/renyi/48/5_d44a9b381edc88181525e3c8350177ca.png)
 任意

[18 天](/t/topic/726007/9?u=niyan2025 "发布日期")

没使用它调过MCP ![](https://linux.do/images/emoji/twemoji/joy.png?v=14)

  

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/zreal/96/458978_2.png)
](/u/zreal)

[zreal](/u/zreal)

[18 天](/t/topic/726007/10?u=niyan2025 "发布日期")

我晕，正要写一个WSL2 + Claude 全家桶保姆级配置指南  
算了，那就推荐一个[awesome-claude-code: A curated list of awesome commands, files, and workflows for Claude Code](https://github.com/hesreallyhim/awesome-claude-code)

  

2 个回复

1

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/xieyang/96/749837_2.png)
](/u/xieyang)

[Mras](/u/xieyang)[xieyang](/u/xieyang)活跃用户

 ![](https://linux.do/user_avatar/linux.do/zreal/48/458978_2.png)
 zreal

[18 天](/t/topic/726007/11?u=niyan2025 "发布日期")

感谢推荐

  

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/xieyang/96/749837_2.png)
](/u/xieyang)

[Mras](/u/xieyang)[xieyang](/u/xieyang)活跃用户

 ![](https://linux.do/user_avatar/linux.do/handsome/48/736205_2.png)
 大帅哥

[18 天](/t/topic/726007/12?u=niyan2025 "发布日期")

大帅哥随处可见啊

  

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/oopss/96/338653_2.png)
](/u/Oopss)

[聚道夫](/u/Oopss)[Oopss](/u/Oopss)一元复始

[18 天](/t/topic/726007/13?u=niyan2025 "发布日期")

羡慕 然而么有API

  

1 个回复

​ ​ 回复

[![](https://linux.do/letter_avatar/renyi/96/5_d44a9b381edc88181525e3c8350177ca.png)
](/u/renyi)

[任意](/u/renyi)[renyi](/u/renyi)

 ![](https://linux.do/user_avatar/linux.do/zreal/48/458978_2.png)
 zreal

[18 天](/t/topic/726007/14?u=niyan2025 "发布日期")

可以开个贴，我估计还是用wsl更好，因为claude执行的一些linux命令在windows里不一定兼容。

但是请问我在wsl2里怎么给claude代理，我用的是v2ray，发现cmd和wsl都无法自动代理，但是docker容器可以代理。开了proxifier，cmd也能代理了，但是wsl2仍然没有代理

  

1 个回复

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/xieyang/96/749837_2.png)
](/u/xieyang)

[Mras](/u/xieyang)[xieyang](/u/xieyang)活跃用户

 ![](https://linux.do/user_avatar/linux.do/oopss/48/338653_2.png)
 聚道夫

[18 天](/t/topic/726007/15?u=niyan2025 "发布日期")

用的pro账号登录的，我也没有api

  

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/xieyang/96/749837_2.png)
](/u/xieyang)

[Mras](/u/xieyang)[xieyang](/u/xieyang)活跃用户

 ![](https://linux.do/letter_avatar/renyi/48/5_d44a9b381edc88181525e3c8350177ca.png)
 任意

[18 天](/t/topic/726007/16?u=niyan2025 "发布日期")

是的，官方就是使用WSL，我是因为加密软件的原因

  

1 个回复

​ ​ 回复

[![](https://linux.do/letter_avatar/renyi/96/5_d44a9b381edc88181525e3c8350177ca.png)
](/u/renyi)

[任意](/u/renyi)[renyi](/u/renyi)

 ![](https://linux.do/user_avatar/linux.do/xieyang/48/749837_2.png)
 Mras

[18 天](/t/topic/726007/17?u=niyan2025 "发布日期")

wsl我不知道怎么弄代理，在wsl里也安装一个代理吗

  

1 个回复

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/cppcloud/96/115656_2.png)
](/u/cppcloud)

[cppcloud](/u/cppcloud)

 ![](https://linux.do/letter_avatar/renyi/48/5_d44a9b381edc88181525e3c8350177ca.png)
 任意

[18 天](/t/topic/726007/18?u=niyan2025 "发布日期")

我是使用国内claude code中转站，公司服务器不能使用魔法网络，感觉还行 ![](https://linux.do/images/emoji/twemoji/rofl.png?v=14)

  

1 个回复

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/dext7r/96/227697_2.png)
](/u/dext7r)

[dext7r](/u/dext7r)一元复始

 ![](https://linux.do/user_avatar/linux.do/cppcloud/48/115656_2.png)
 cppcloud

[16 天](/t/topic/726007/19?u=niyan2025 "发布日期")

[![](https://linux.do/uploads/default/optimized/4X/3/c/7/3c7b09e368fc355402fc8764b14bdafd20e452f4_2_362x500.png)

image1156×1596 111 KB

](https://linux.do/uploads/default/original/4X/3/c/7/3c7b09e368fc355402fc8764b14bdafd20e452f4.png "image")

  
佬。用国内的应该如何配置代理和key呢，  

[![](https://linux.do/uploads/default/optimized/4X/7/c/3/7c38dc4d3a7075286bca904e7c01a470066d416b_2_515x500.jpeg)

e6cd2b28470d5cdc7882e1a50e175cfa909×882 137 KB

](https://linux.do/uploads/default/original/4X/7/c/3/7c38dc4d3a7075286bca904e7c01a470066d416b.jpeg "e6cd2b28470d5cdc7882e1a50e175cfa")

![](https://linux.do/uploads/default/original/4X/8/7/4/8742ba4fda8d7303bab907ac19c10eff18b8cc90.png)
 [Anthropic](https://docs.anthropic.com/zh-CN/docs/claude-code/settings#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F)

![](https://linux.do/uploads/default/optimized/4X/6/0/c/60c28830b119ff3d91cfedab1e2d65fbf03ce373_2_690x362.png)

### [Claude Code 设置 - Anthropic](https://docs.anthropic.com/zh-CN/docs/claude-code/settings#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F)

了解如何通过全局和项目级设置、主题和环境变量配置 Claude Code。

已看过文档。

  

2 个回复

​ ​ 回复

[![](https://linux.do/user_avatar/linux.do/pzyyl/96/764019_2.png)
](/u/pzyyl)

[pzyyl](/u/pzyyl)

 ![](https://linux.do/user_avatar/linux.do/dext7r/48/227697_2.png)
 dext7r

[16 天](/t/topic/726007/20?u=niyan2025 "发布日期")

{  
“env”: {  
“HTTP\_PROXY”: “”,  
}

  

1 个回复

![](https://linux.do/uploads/default/original/3X/2/e/2e09f3a3c7b27eacbabe9e9614b06b88d5b06343.png?v=14)

tieba\_087

1

​ ​ 回复

Invalid date Invalid date

↑↓⇔⇧⇩