# ğŸ’ G.E.M. - è®© Gemini è‡ªåŠ¨ç»­å†™è¢«æˆªæ–­çš„å¯¹è¯ã€æ— ç¼æ–­ç‚¹ç»­ä¼ ã€‘ - å¼€å‘è°ƒä¼˜ / å¼€å‘è°ƒä¼˜, Lv1 - LINUX DO
[ğŸ’ G.E.M. - è®© Gemini è‡ªåŠ¨ç»­å†™è¢«æˆªæ–­çš„å¯¹è¯ã€æ— ç¼æ–­ç‚¹ç»­ä¼ ã€‘ - å¼€å‘è°ƒä¼˜ / å¼€å‘è°ƒä¼˜, Lv1 - LINUX DO](https://linux.do/t/topic/741953/4) 

  ğŸ’ G.E.M. - è®© Gemini è‡ªåŠ¨ç»­å†™è¢«æˆªæ–­çš„å¯¹è¯ã€æ— ç¼æ–­ç‚¹ç»­ä¼ ã€‘ - å¼€å‘è°ƒä¼˜ / å¼€å‘è°ƒä¼˜, Lv1 - LINUX DO                                                

[è·³åˆ°ä¸»è¦å†…å®¹](#main-container)

 [![](https://linux.do/uploads/default/original/3X/9/d/9dd49731091ce8656e94433a26a3ef36062b3994.png)](/) 

 [![](https://linux.do/images/emoji/twemoji/gem_stone.png?v=14)
 G.E.M. - è®© Gemini è‡ªåŠ¨ç»­å†™è¢«æˆªæ–­çš„å¯¹è¯ã€æ— ç¼æ–­ç‚¹ç»­ä¼ ã€‘](/t/topic/741953)


=========================================================================================================================

[å¼€å‘è°ƒä¼˜](/c/develop/4)

[å¼€å‘è°ƒä¼˜, Lv1](/c/develop/develop-lv1/20)

[äººå·¥æ™ºèƒ½](/tag/äººå·¥æ™ºèƒ½)

*   â€‹

*    ![](https://linux.do/letter_avatar/niyan2025/96/5_d44a9b381edc88181525e3c8350177ca.png)
       [ 2 ](# "2 ä¸ªæœªè¯»é€šçŸ¥") 

*   [è¯é¢˜](/latest "æ‰€æœ‰è¯é¢˜")
*   [æˆ‘çš„å¸–å­](/u/niyan2025/activity/drafts "æˆ‘çš„æœªå‘å¸ƒè‰ç¨¿")
*   [å…³äº](/about "å…³äºæ­¤ç½‘ç«™çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯")
*   [å³å°†åˆ°æ¥çš„æ´»åŠ¨](/upcoming-events "å³å°†åˆ°æ¥çš„æ´»åŠ¨")
*   æ›´å¤š

å¤–éƒ¨é“¾æ¥

*   [2048](https://2048.linux.do)
*   [Status](https://status.linux.do)
*   [T-Shirt](https://shanwaiyoushan.taobao.com)
*   [Connect](https://connect.linux.do)
*   [Webmail](https://webmail.linux.do)
*   [Channel](https://t.me/linux_do_channel)
*   [Telegram](https://t.me/ja_netfilter_group)

ç±»åˆ«

*   [å¼€å‘è°ƒä¼˜](/c/develop/4 "æ­¤ç‰ˆå—åŒ…å«å¼€å‘ã€æµ‹è¯•ã€è°ƒè¯•ã€éƒ¨ç½²ã€ä¼˜åŒ–ã€å®‰å…¨ç­‰æ–¹é¢çš„å†…å®¹")
*   [èµ„æºèŸèƒ](/c/resource/14 "åŒ…æ‹¬è½¯ä»¶åˆ†äº«ã€å¼€æºä»“åº“ã€è§†é¢‘è¯¾ç¨‹ã€ä¹¦ç±ç­‰åˆ†äº«")
*   [æ–‡æ¡£å…±å»º](/c/wiki/42 "ä½¬å‹åŒ–èº«ç¿°æ—å­¦å£«ï¼Œä¸€èµ·æ¥ç¼–ä¹¦äº†ã€‚")
*   [éæˆ‘è«å±](/c/job/27 "å­¦æˆæ–‡æ­¦è‰ºï¼Œè´§ä¸å¸ç‹å®¶ã€‚æ‹›è˜/æ±‚èŒåˆ†ç±»ï¼Œåªèƒ½å‘æ­¤ç±»ä¿¡æ¯ã€‚")
*   [è¯»ä¹¦æˆè¯—](/c/reading/32 "è·Ÿç€ä½¬å‹ä»¬ä¸€èµ·åœ¨è®ºå›è¯»å®Œä¸€æœ¬ä¹¦æ˜¯ä»€ä¹ˆä½“éªŒï¼Ÿ")
*   [æ‰¬å¸†èµ·èˆª](/c/startup/46 "æ‰¬å¸†èµ·èˆªï¼Œç›®æ ‡æ˜¯æ˜Ÿè¾°å¤§æµ·ï¼")
*   [å‰æ²¿å¿«è®¯](/c/news/34 "å‰æ²¿å¿«è®¯ï¼Œä¸å‡ºé—¨èƒ½çŸ¥å¤©ä¸‹äº‹ã€‚")
*   [ç½‘ç»œè®°å¿†](/c/feeds/92 "ç½‘ç»œæ˜¯æœ‰è®°å¿†çš„ï¼Œç¡®ä¿¡ï¼")
*   [ç¦åˆ©ç¾Šæ¯›](/c/welfare/36 "æ­£ç»äººè°èŠ±é‚£ä¸ªé’±å•Šï½ æ­¤ç‰ˆå—ä¾›ç¾Šæ¯›ã€æŠ½å¥–ç­‰ç¦åˆ©ä½¿ç”¨ã€‚")
*   [æä¸ƒæ»ä¸‰](/c/gossip/11 "é—²èŠå¹æ°´çš„æ¿å—ã€‚ä¸å¾—è®¨è®ºæ”¿æ²»ã€è‰²æƒ…ç­‰è¿è§„å†…å®¹ã€‚")
*   [è¿è¥åé¦ˆ](/c/feedback/2 "æœ‰å…³æ­¤ç«™ç‚¹ã€å…¶ç»„ç»‡ã€è¿ä½œæ–¹å¼ä»¥åŠå¦‚ä½•æ”¹è¿›çš„è®¨è®ºã€‚")
*   [æ·±æµ·å¹½åŸŸ](/c/muted/45 "å†°å±±ä¸‹çš„æ·±æµ·ã€‚å¸–å­ä¸ä¼šä¸Šä¿¡æ¯æµã€ä¸ä¼šè¢«è®ºå›æœç´¢ã€‚")
*   [æ‰€æœ‰ç±»åˆ«](/categories)

æ ‡ç­¾

*   [äººå·¥æ™ºèƒ½](/tag/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD)
*   [å…¬å‘Š](/tag/%E5%85%AC%E5%91%8A)
*   [å¿«é—®å¿«ç­”](/tag/%E5%BF%AB%E9%97%AE%E5%BF%AB%E7%AD%94)
*   [æŠ½å¥–](/tag/%E6%8A%BD%E5%A5%96)
*   [ç²¾åç¥å¸–](/tag/%E7%B2%BE%E5%8D%8E%E7%A5%9E%E5%B8%96)
*   [æ‰€æœ‰æ ‡ç­¾](/tags)

æ¶ˆæ¯

*   [æ”¶ä»¶ç®±](/u/niyan2025/messages)

*   [æˆ‘çš„æ¶ˆæ¯ä¸²](/chat/threads "æˆ‘çš„æ¶ˆæ¯ä¸²")

é¢‘é“

*   [å¸¸è§„é¢‘é“](/chat/c/general/2 "ğŸˆ² ç¦æ­¢åœ¨èŠå¤©é¢‘é“é‡Œå‘é€ æ‰“å¡ ç­‰æ— æ„ä¹‰ä¿¡æ¯ï¼Œè¢«ä¸¾æŠ¥ä¼šå–œæ ç¦è¨€1å°æ—¶ ã€‚")

ç›´æ¥æ¶ˆæ¯

*    [![](https://linux.do/user_avatar/linux.do/xronus/48/130867_2.png)  ğ’œğ“ƒğ’¾ğ“‹ğ’¾ğ“](/chat/c/%F0%9D%92%9C%F0%9D%93%83%F0%9D%92%BE%F0%9D%93%8B%F0%9D%92%BE%F0%9D%93%8D/32458 "ä¸ ğ’œğ“ƒğ’¾ğ“‹ğ’¾ğ“ èŠå¤©") 
*    [![](https://linux.do/user_avatar/linux.do/huan/48/293194_2.png)  ç„•æ˜­å›](/chat/c/%E7%84%95%E6%98%AD%E5%90%9B/43057 "ä¸ ç„•æ˜­å› èŠå¤©") 
*    [![](https://linux.do/user_avatar/linux.do/wenjuhe/48/672301_2.png)  å¥‡å¦™è¿›åŒ–å°æ²³é©¬ğŸ¦›   ![](https://linux.do/images/emoji/twemoji/hippopotamus.png?v=14)](/chat/c/%E5%A5%87%E5%A6%99%E8%BF%9B%E5%8C%96%E5%B0%8F%E6%B2%B3%E9%A9%AC%F0%9F%A6%9B/45968 "ä¸ å¥‡å¦™è¿›åŒ–å°æ²³é©¬ğŸ¦› èŠå¤©") 

èŠå¤©

Default

â€‹ â€‹ â€‹

**çœŸè¯š**ã€**å‹å–„**ã€**å›¢ç»“**ã€**ä¸“ä¸š**ï¼Œå…±å»ºä½ æˆ‘å¼•ä»¥ä¸ºè£ä¹‹ç¤¾åŒºã€‚[ã€Šå¸¸è§é—®é¢˜è§£ç­”ã€‹](/faq)

[

â¤ï¸ å†å¿ä¸ä½ï¼Œä¹Ÿä¸è¦åšè¿™ç§äº‹å•Š â¤ï¸

](https://linux.do/t/topic/482293)

 [![](https://linux.do/images/emoji/twemoji/gem_stone.png?v=14)
 G.E.M. - è®© Gemini è‡ªåŠ¨ç»­å†™è¢«æˆªæ–­çš„å¯¹è¯ã€æ— ç¼æ–­ç‚¹ç»­ä¼ ã€‘](/t/topic/741953) 


==========================================================================================================================

[å¼€å‘è°ƒä¼˜](/c/develop/4)

[å¼€å‘è°ƒä¼˜, Lv1](/c/develop/develop-lv1/20)

[äººå·¥æ™ºèƒ½](/tag/äººå·¥æ™ºèƒ½)

æ‚¨å·²é€‰æ‹© **0** ä¸ªå¸–å­ã€‚

å…¨é€‰

å–æ¶ˆé€‰æ‹©

â€‹

[6æœˆ 21 æ—¥](/t/topic/741953/1 "è·³åˆ°ç¬¬ä¸€ä¸ªå¸–å­")

4 / 38

6æœˆ 21 æ—¥

è¿”å›

[1 å°æ—¶](/t/topic/741953/38)

â€‹

[![](https://linux.do/user_avatar/linux.do/0v0/96/46947_2.png)
](/u/0v0)

[0v0](/u/0v0)

8

[1 å¤©](/t/topic/741953?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

[](#p-6762283-gemini-elastic-middleware-gem-1)![](https://linux.do/images/emoji/twemoji/gem_stone.png?v=14)
 Gemini Elastic Middleware (G.E.M.)
===============================================================================================================================================

### [](#p-6762283-globe_with_meridians-2)![](https://linux.do/images/emoji/twemoji/globe_with_meridians.png?v=14)
 è¿™æ˜¯ä»€ä¹ˆ

è¿™æ˜¯ä¸€ä¸ªå…¼å®¹ Gemini æ ¼å¼ã€èƒ½åœ¨å“åº”è¢«æˆªæ–­æ—¶å¿«é€Ÿç»­ä¼ çš„æµå¼ APIã€‚

_demoï¼ˆå¼€ç®±å³ç”¨ï¼‰ï¼š_  
_[ç”¨unfiltered.pages.devæ›¿æ¢generativelanguage.googleapis.com](https://unfiltered.pages.dev)_

_ï¼Œå…¶ä»–ä¸€åˆ‡ç…§æ—§å³å¯~_

_ç§æœ‰éƒ¨ç½²ï¼ˆCloudflare Workers / Deno Deploy):_

source code```


``// Configuration: upstream Google API host and maximum retry attempts
const upstream_url_base = "https://generativelanguage.googleapis.com";
const max_consecutive_failures = 5; 
const debug_mode = true;

// Handle CORS preflight requests
const handleOPTIONS = async () =>
  new Response(null, {
    headers: {
      "Access-Control-Allow-Origin": "*",
      "Access-Control-Allow-Methods": "*",
      "Access-Control-Allow-Headers": "*",
    },
  });

function logDebug(...args) {
  if (debug_mode) {
    console.log('DEBUG - ', ...args);
  }
}

// Relay non-POST requests as-is to upstream
async function relayNonStream(request) {
  const originalUrl = new URL(request.url);
  const upstreamUrl = `${upstream_url_base}${originalUrl.pathname}${originalUrl.search}`;
  
  logDebug(`Relaying ${request.method} request to: ${upstreamUrl}`);
  
  const upstreamResponse = await fetch(upstreamUrl, {
    method: request.method,
    headers: request.headers,
    body: request.body
  });
  
  logDebug(`Upstream ${request.method} response status: ${upstreamResponse.status}`);
  
  // Return response with same headers and body
  return new Response(upstreamResponse.body, {
    status: upstreamResponse.status,
    statusText: upstreamResponse.statusText,
    headers: upstreamResponse.headers
  });
}

// Parse Server-Sent Events (SSE) stream line by line
async function* sseLineIterator(reader) {
  const decoder = new TextDecoder("utf-8");
  let buffer = "";
  while (true) {
    const { value, done } = await reader.read();
    if (value) {
      buffer += decoder.decode(value, { stream: true });
    }
    // Split buffer by newlines (support both \n and \r\n)
    const lines = buffer.split(/\r?\n/);
    buffer = lines.pop(); 
    // Yield each complete line
    for (const line of lines) {
      if (line.trim()) {
        yield line;
      }
    }
    // If stream is done, yield any remaining content
    if (done) {
      if (buffer.trim()) {
        yield buffer;
      }
      break;
    }
  }
}

// Extract text content from SSE data line
function extractTextFromSSELine(line) {
  if (!line.startsWith('data: ')) return null;
  try {
    const jsonStr = line.slice(6); // Remove 'data: ' prefix
    const data = JSON.parse(jsonStr);
    // Navigate through the nested structure to get text
    const text = data?.candidates?.[0]?.content?.parts?.[0]?.text;
    return text || null;
  } catch (e) {
    logDebug(`Failed to extract text from SSE line: ${line}, error: ${e.message}`);
    return null;
  }
}

// Check if the line contains a finishReason and extract it
function checkFinishReason(line) {
  if (!line.includes('finishReason')) return null;
  // Find the start of JSON object
  const firstBraceIndex = line.indexOf('{');
  if (firstBraceIndex === -1) return null;
  try {
    const jsonStr = line.slice(firstBraceIndex);
    const data = JSON.parse(jsonStr);
    const finishReason = data?.candidates?.[0]?.finishReason || null;
    logDebug(`Extracted finishReason: ${finishReason}`);
    return finishReason;
  } catch (e) {
    logDebug(`Failed to parse finishReason from line: ${line}, error: ${e.message}`);
    return null;
  }
}

// Build a new request body for retry with accumulated text
function buildRetryRequestBody(originalRequestBody, aggText, isReasoningModel) {
  // Minimize reasoning token budget for fast retry
  // https://ai.google.dev/gemini-api/docs/thinking
  if (isReasoningModel) {
    originalRequestBody.generationConfig.thinkingConfig =  { 
      ...originalRequestBody.generationConfig.thinkingConfig, 
      thinkingBudget: 128,
      includeThoughts: false 
    };  
  }

  // Deep copy the original request body
  const retryRequestBody = JSON.parse(JSON.stringify(originalRequestBody)); 
  
  logDebug(`Building retry request body with accumulated text length: ${aggText.length}`);
  
  // Ensure contents array exists
  if (!retryRequestBody.contents) {
    retryRequestBody.contents = [];
  }

  // If last message is not from user, add model response and user continue prompt
  if (retryRequestBody.contents.length > 0 && 
      retryRequestBody.contents[retryRequestBody.contents.length - 1].role !== "user") {
    retryRequestBody.contents.push({ role: "model", parts: [{ text: "" }]});
    retryRequestBody.contents.push({ role: "user", parts: [{ text: "continue" }]}); 
    logDebug(`Added empty model response and continue prompt`);
  }
  
  // Add accumulated text as model's previous response
  retryRequestBody.contents.push({
    role: "model",
    parts: [{ text: aggText }]
  });
  
  logDebug(`Added accumulated text as model response. Total conversation length: ${retryRequestBody.contents.length}`);
  
  return retryRequestBody;
}

// Main function to relay requests and handle retries on truncation
async function relayAndRetry(originalRequest, writer) {
  const encoder = new TextEncoder();
  let retryCount = 0;
  let AGG_TEXT = ""; // Accumulated text from all attempts
  let originalRequestBody;
  
  const geminiVersionMatch = new URL(originalRequest.url).pathname.match(/gemini-(\d+(?:\.\d+)?)/);
  const isReasoningModel = geminiVersionMatch && parseFloat(geminiVersionMatch[1]) >= 2.5;
  
  if (isReasoningModel) {
    logDebug(`Detected Gemini version >= 2.5, will force includeThoughts to true`);
  }

  try {
    originalRequestBody = await originalRequest.clone().json();
    logDebug(`Original request body parsed successfully`);

    if (isReasoningModel) {
      originalRequestBody.generationConfig.thinkingConfig =  { 
        ...originalRequestBody.generationConfig.thinkingConfig, 
        includeThoughts: true 
      };
      logDebug(`Overrode thinkingConfig.includeThoughts to true`);
    }
  } catch (e) {
    logDebug(`Failed to parse original request body: ${e.message}`);
    throw new Error(`Invalid JSON in request body: ${e.message}`);
  }
  
  let currentRequestBody = JSON.parse(JSON.stringify(originalRequestBody));

  while (retryCount <= max_consecutive_failures) {
    let needsRetry = false;
    let reader = null;
    
    logDebug(`Starting attempt ${retryCount + 1}/${max_consecutive_failures + 1}`);
    
    try {
      // Construct upstream URL with Google API host
      const originalUrl = new URL(originalRequest.url);
      const upstreamUrl = `${upstream_url_base}${originalUrl.pathname}${originalUrl.search}`;
      
      logDebug(`Making request to upstream: ${upstreamUrl}`);

      const reqBody = JSON.stringify(currentRequestBody);

      // Make request to upstream Google API - preserve all original request details except body
      const upstreamResponse = await fetch(upstreamUrl, {
        method: originalRequest.method,
        headers: originalRequest.headers,
        body: reqBody
      });

      logDebug(`Request Body: ${reqBody}`);
      
      logDebug(`Upstream response status: ${upstreamResponse.status} ${upstreamResponse.statusText}`);
      
      if (!upstreamResponse.ok) {
          throw new Error(`Upstream error: ${upstreamResponse.status} ${upstreamResponse.statusText}`);
      }
      
      reader = upstreamResponse.body.getReader();
      let textReceivedInThisAttempt = false;
      let isBlocked = false;
      
      // Process SSE stream line by line
      for await (const line of sseLineIterator(reader)) {
          logDebug(`Processing SSE line: ${line.substring(0, 100)}${line.length > 100 ? '...' : ''}`);
          
          const finishReason = checkFinishReason(line);
          isBlocked = line.includes('blockReason');

          if (finishReason !== null) {
              logDebug(`Received finishReason: ${finishReason}`);
              
              // Check if response was truncated (not a normal completion)
              if (finishReason && finishReason !== "STOP" && finishReason !== "MAX_TOKENS") {
                  logDebug(`[Attempt ${retryCount + 1}] Detected abnormal finish reason: ${finishReason}, preparing to retry...`);
                  needsRetry = true;
                  break; // Exit loop to retry
              } else {
                  // Normal completion - forward line and close stream
                  await writer.write(encoder.encode(line + '\n\n'));
                  await writer.close();
                  logDebug(`[Attempt ${retryCount + 1}] Request finished successfully. Finish reason: ${finishReason || "STOP"}`);
                  return; // Success - exit function
              }
          } else {
              // Regular content line - extract text and forward
              const text = extractTextFromSSELine(line);
              if (text) {
                  AGG_TEXT += text; // Accumulate text
                  textReceivedInThisAttempt = true;
                  logDebug(`Extracted text chunk of length: ${text.length}, total accumulated: ${AGG_TEXT.length}`);
              }
              
              if (!isBlocked) {
                await writer.write(encoder.encode(line + '\n\n'));
                logDebug(`Forwarded SSE line to client`);
              } else {
                logDebug(`Blocked line detected, not forwarding: ${line}`);
              }
          }
      }
      
      // Reset retry count if we received text in this attempt
      if (textReceivedInThisAttempt) {
        retryCount = 0;
        logDebug(`Reset retry count due to successful text reception`);
      }
      
      // If stream ended without finishReason, treat as truncation
      if (!needsRetry && isBlocked) {
        logDebug(`[Attempt ${retryCount + 1}] Stream blocked, preparing to retry...`);
        needsRetry = true;
      }
      
    } catch (error) {
      logDebug(`[Attempt ${retryCount + 1}] Fetch or processing error: ${error.message}`);
      console.error(`[Attempt ${retryCount + 1}] Fetch or processing error:`, error);
      needsRetry = true;
    } finally {
      // Clean up reader to prevent resource leaks
      if (reader) {
        try {
          await reader.cancel();
          logDebug(`Reader cancelled successfully`);
        } catch (e) {
          logDebug(`Failed to cancel reader: ${e.message}`);
        }
      }
    }

    if (needsRetry) {
        retryCount++;
        if (retryCount > max_consecutive_failures) {
            // Max retries exceeded - send error and close
            logDebug(`Max retries (${max_consecutive_failures}) exceeded. Closing stream.`);
            console.error("Max retries exceeded. Closing stream.");
            const errorPayload = { error: { message: "Max retries exceeded after multiple upstream failures." } };
            await writer.write(encoder.encode('data: ' + JSON.stringify(errorPayload) + '\n\n'));
            await writer.close();
            return;
        }
        
        // Build new request body with accumulated text for retry
        currentRequestBody = buildRetryRequestBody(originalRequestBody, AGG_TEXT, isReasoningModel);
        logDebug(`[Attempt ${retryCount + 1}] Prepared retry with accumulated text length: ${AGG_TEXT.length}`);
    } else {
        // Success - exit loop
        logDebug(`Request completed successfully without retry`);
        break;
    }
  }
}

// Main request handler
async function handleRequest(request, env) {
  logDebug(`Received ${request.method} request to ${request.url}`);
  
  // Handle CORS preflight
  if (request.method === "OPTIONS") {
    logDebug(`Handling OPTIONS request`);
    return handleOPTIONS();
  }
  
  const { pathname, searchParams } = new URL(request.url, 'http://_');
  const isStream = /stream/i.test(pathname) || searchParams.get('alt')?.toLowerCase() === 'sse'; 

  // For non-POST requests, relay as-is
  if (request.method !== "POST" || !isStream) {
    logDebug(`Relaying non-stream request: ${request.method}`);
    try {
      return await relayNonStream(request);
    } catch (error) {
      logDebug(`Failed to relay non-stream request: ${error.message}`);
      console.error('Non-POST relay error:', error);
      return new Response(JSON.stringify({ error: "Failed to relay request", details: error.message }), 
        { status: 502, headers: { "Content-Type": "application/json" } });
    }
  }

  // Handle POST requests with retry logic
  try {
    logDebug(`Processing POST request for streaming response`);
    
    // Create a streaming response
    const { readable, writable } = new TransformStream();
    const writer = writable.getWriter();

    // Start relay and retry process asynchronously
    // Don't await - let it run in background while we return the stream
    relayAndRetry(request, writer).catch(error => {
      logDebug(`relayAndRetry failed: ${error.message}`);
      console.error('Relay and retry error:', error);
      // Try to send error to client if stream is still writable
      const encoder = new TextEncoder();
      const errorPayload = { error: { message: "Request processing failed", details: error.message } };
      writer.write(encoder.encode('data: ' + JSON.stringify(errorPayload) + '\n\n')).catch(() => {});
      writer.close().catch(() => {});
    });

    // Return SSE stream response
    logDebug(`Returning streaming response`);
    return new Response(readable, {
        headers: {
            'Content-Type': 'text/event-stream; charset=utf-8',
            'Cache-Control': 'no-cache',
            'Connection': 'keep-alive',
            'Access-Control-Allow-Origin': '*',
        }
    });

  } catch (error) {
    logDebug(`Request handling error: ${error.message}`);
    console.error('Request handling error:', error);
    return new Response(JSON.stringify({ error: "Request processing failed", details: error.message }), 
      { status: 400, headers: { "Content-Type": "application/json" } });
  }
}

// Export for Cloudflare Workers
export default { fetch: handleRequest };
// Export for Cloudflare Pages Functions
export const onRequest = (context) => { return handleRequest(context.request, context.env); };

// Deno runtime support for local development
if (typeof Deno !== "undefined") {
  const port = 8000;
  logDebug(`Gemini Elastic Middleware listening on http://localhost:${port}`);
  Deno.serve({ port }, handleRequest);
}`` 
``` 

### [](#p-6762283-leaf_fluttering_in_wind-3)![](https://linux.do/images/emoji/twemoji/leaf_fluttering_in_wind.png?v=14)
 ç¼˜èµ·

æœ€è¿‘åœ¨ç”¨ Gemini API åšä¸€ä¸ªæ–‡çŒ®ç´¢å¼•æœºå™¨äººï¼Œä¸€åˆ‡éƒ½å¾ˆé¡ºåˆ©ï¼Œç›´åˆ°æˆ‘ä»¬å¼€å§‹äº¤ç»™å®ƒä¸€äº›ç•¥é•¿çš„å†…å®¹â€¦

æˆ‘ä»¬æ¸æ¸æ„è¯†åˆ°ï¼ŒGeminiçœŸæ­£çš„é†‰äººä¹‹å¤„ï¼Œä¸ä»…ä»…åœ¨äºå®ƒå‡ºä¼—çš„æ™ºæ…§ï¼Œæ›´åœ¨äºå®ƒç»ƒå¾—ä¸€æ‰‹å¤©èœçº§åˆ«çš„åˆ€æ³•â€”â€”**æ€»æ˜¯èƒ½å¤Ÿæ°å¥½åœ¨ä½ æœ€éœ€è¦å®ƒçš„å…³é”®æ—¶åˆ»åœæ­¢å›åº”ï¼Œå«äººæ¬²ç½¢ä¸èƒ½ï¼**

åœ¨ Reddit é€›äº†ä¸€åœˆï¼Œå‘ç°ä¸å°‘è€å¤–è¸©äº†è¿™ä¸ªå‘ï¼Œå®˜æ–¹æ–‡æ¡£ä¹Ÿæ— ä¸åœ¨æš—ç¤ºâ€œè¿™æ˜¯æˆ‘ä»¬ä¸‹çš„ä¸€ç›˜å¤§æ£‹â€ï¼š

![](https://linux.do/uploads/default/original/3X/b/2/b2a2be7cc9c7442d916d15b4c40049e353cd51bf.png)
 [Google AI for Developers](https://ai.google.dev/api/generate-content?hl=zh-cn#FinishReason)

![](https://linux.do/uploads/default/optimized/4X/9/b/4/9b4999fbe2ca00a707813de32d614b9290e84ce6_2_690x362.png)

### [Generating content Â |Â  Gemini API Â |Â  Google AI for...](https://ai.google.dev/api/generate-content?hl=zh-cn#FinishReason)

**æ€»ç»“çœ‹æ¥è¿™æ˜¯ Gemini API çš„ä¸€ä¸ª"åŠŸèƒ½" â€”â€” å½“å†…ç½®çš„å®¡æ ¸æ¨¡å‹è§‰å¾—å†…å®¹å¯èƒ½æ¶‰åŠç‰ˆæƒï¼Œæˆ–è€…è§¦å‘äº†æŸäº›å†…éƒ¨çš„å®‰å…¨æœºåˆ¶ï¼Œè°·æ­Œçš„ç”œèœè¿‡æ»¤å™¨å°±ä¼šä½“è´´åœ°å¸®ä½ æ‚ä¸ŠGeminiçš„å˜´ã€‚** 

**ä¸è¿‡å’±ä»¬çš„ Gemini è¿˜æ˜¯å¾ˆæœ‰èŒä¸šç´ å…»çš„ï¼**

å®ƒè¦æ˜¯æ‰“ç®—ç½¢å·¥ï¼Œç»ä¸ä¼šä¸å£°ä¸å“åœ°æºœå·ï¼Œè€Œæ˜¯ä¼šåœ¨å…³æœºå‰ç•™ä¸ªå­—æ¡ï¼Œç”¨ finishReason æ˜æ˜ç™½ç™½åœ°å‘Šè¯‰ä½ ï¼šâ€œæ•ä¸å¥‰é™ªï¼Œç†ç”±å¦‚ä¸‹ã€‚â€

| æˆªæ–­åŸå›  | è¯´æ˜ | ç±»å‹ |
| --- | --- | --- |
| **STOP** | æ¨¡å‹è‡ªç„¶ç»“æŸæˆ–é‡åˆ°åœæ­¢åºåˆ— | ![](https://linux.do/images/emoji/twemoji/white_check_mark.png?v=14)
 æ­£å¸¸ç»“æŸ |
| **MAX\_TOKENS** | è¾¾åˆ°è¯·æ±‚è®¾å®šçš„æœ€å¤§tokenæ•°é™åˆ¶ | ![](https://linux.do/images/emoji/twemoji/white_check_mark.png?v=14)
 æ­£å¸¸ç»“æŸ |
| **RECITATION** | æ£€æµ‹åˆ°å¤§æ®µå¼•ç”¨æˆ–èƒŒè¯µå†…å®¹ | ![](https://linux.do/images/emoji/twemoji/warning.png?v=14)
 ç‰ˆæƒè§„é¿ |
| **PROHIBITED\_CONTENT** | å¯èƒ½åŒ…å«è¿ç¦å†…å®¹ | ![](https://linux.do/images/emoji/twemoji/prohibited.png?v=14)
 å†…å®¹å°é” |
| **SAFETY** | å†…å®¹è§¦å‘å®‰å…¨å®¡æŸ¥æœºåˆ¶ | ![](https://linux.do/images/emoji/twemoji/warning.png?v=14)
 å®‰å…¨è¿‡æ»¤ |
| **BLOCKLIST** | åŒ…å«ç¦ç”¨è¯æ±‡ | ![](https://linux.do/images/emoji/twemoji/prohibited.png?v=14)
 å†…å®¹å°é” |
| **SPII** | æ£€æµ‹åˆ°æ•æ„Ÿä¸ªäººèº«ä»½ä¿¡æ¯ | ![](https://linux.do/images/emoji/twemoji/locked.png?v=14)
 éšç§ä¿æŠ¤ |
| **LANGUAGE** | ä½¿ç”¨äº†ä¸æ”¯æŒçš„è¯­è¨€ | ![](https://linux.do/images/emoji/twemoji/warning.png?v=14)
 è¯­è¨€é™åˆ¶ |
| **OTHER** | æœªçŸ¥åŸå› å¯¼è‡´ä¸­æ–­ | ![](https://linux.do/images/emoji/twemoji/red_question_mark.png?v=14)
 å¼‚å¸¸ä¸­æ–­ |

> **è¯´æ˜**ï¼šåªæœ‰ `STOP` å’Œ `MAX_TOKENS` å±äºæ­£å¸¸ç»“æŸï¼Œå…¶ä»–åŸå› éƒ½ä¼šè§¦å‘GEMçš„è‡ªåŠ¨ç»­å†™æœºåˆ¶ã€‚

**å¥½åœ¨Geminiä¹Ÿä¸æ˜¯é“æ¿ä¸€å—â€”â€”åªè¦ä½ è€å¿ƒåœ°æ‹æ‹å®ƒè¯´"æ¥æ¥æ¥ï¼Œå’±ä»¬æ¥ç€èŠ"ï¼ŒGemini å¤§å¤šæ•°æ—¶å€™è¿˜æ˜¯ä¼šä¹–ä¹–å›æ¥ç»§ç»­å¹²æ´»çš„ã€‚** 

è¿™ä¸å°±æœ‰æ„æ€äº†å—ï¼Ÿæ—¢ç„¶å®ƒä¼šæå‰æ‰“æ‹›å‘¼è¯´è¦æºœï¼Œè€Œä¸”ç‰¹åœ°ç•™äº†å•†é‡çš„ä½™åœ°ï¼Œ**é‚£æˆ‘ä»¬ä½•ä¸æä¸ªè‡ªåŠ¨åŒ–çš„"èµ›åšç›‘å·¥"ï¼Ÿä¸“é—¨è¹²åœ¨é‚£å„¿ï¼Œä¸€çœ‹åˆ° Gemini è¢«æ‚å˜´äº†ï¼Œç«‹é©¬å†²ä¸Šå»è¯´ï¼š"åˆ«åœï¼æ¥ç€å¥ä¹æ¥ç€èˆï¼"è¿™æ ·ä¸å°±å®Œç¾è§£å†³äº†å—ï¼Ÿ**

### [](#p-6762283-cherries-4)![](https://linux.do/images/emoji/twemoji/cherries.png?v=14)
 æœ€å°ä¸”å¯è¡Œçš„è§£å†³æ–¹æ¡ˆ

äºæ˜¯å†™äº†ä¸ªä¸­é—´ä»¶ï¼Œæ ¸å¿ƒæ€è·¯ä¹Ÿç®€å•å¾—å¾ˆï¼š

**å¦‚æœ AI è¯´åˆ°ä¸€åŠä¸è¯´äº†ï¼Œé‚£å°±è®©å®ƒæ¥ç€è¯´ï¼**

å…·ä½“æ¥è¯´ï¼š

1.  æŠŠå·²ç»ç”Ÿæˆçš„å†…å®¹å­˜èµ·æ¥
    
2.  å‘Šè¯‰ AIï¼šâ€œä½ åˆšæ‰è¯´åˆ°è¿™é‡Œäº†ï¼Œç»§ç»­è¯´â€
    
3.  æŠŠæ–°ç”Ÿæˆçš„å†…å®¹æ¥åœ¨åé¢
    
4.  å¯¹ç”¨æˆ·æ¥è¯´ï¼Œçœ‹èµ·æ¥å°±åƒä¸€æ¬¡æ€§ç”Ÿæˆçš„
    

**æ‰“ä¸ªæ¯”æ–¹ï¼Œå°±åƒä½ åœ¨å¬æœ‹å‹è®²æ•…äº‹ï¼Œä»–çªç„¶å¡å£³äº†ï¼Œä½ å°±è¯´ï¼šâ€œä½ åˆšæ‰è®²åˆ°ä¸»è§’è¿›äº†å±±æ´ï¼Œç„¶åå‘¢ï¼Ÿâ€ æœ‹å‹å°±ä¼šç»§ç»­å¾€ä¸‹è®²ã€‚** 

### [](#p-6762283-building_construction-5)![](https://linux.do/images/emoji/twemoji/building_construction.png?v=14)
 è¿™ä¸ªä¸­é—´ä»¶æ˜¯æ€ä¹ˆå·¥ä½œçš„

[![](https://linux.do/uploads/default/optimized/4X/a/6/4/a647714cae3e01604c3e0ec24b076dcf6c0c3b34_2_690x185.png)

image1021Ã—274 16.5 KB

](https://linux.do/uploads/default/original/4X/a/6/4/a647714cae3e01604c3e0ec24b076dcf6c0c3b34.png "image")

æ•´ä¸ªè¿‡ç¨‹å¯¹å®¢æˆ·ç«¯å®Œå…¨é€æ˜ï¼š

1.  å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªæ™®é€šçš„ Gemini API è¯·æ±‚
    
2.  ä¸­é—´ä»¶è½¬å‘ç»™çœŸæ­£çš„ API
    
3.  å®æ—¶ç›‘æ§è¿”å›çš„æ•°æ®æµ
    
4.  ä¸€æ—¦å‘ç°å¼‚å¸¸ä¸­æ–­ï¼Œç«‹å³æ„é€ "ç»§ç»­"è¯·æ±‚
    
5.  æŠŠæ‰€æœ‰ç‰‡æ®µæ— ç¼æ‹¼æ¥åè¿”å›ç»™å®¢æˆ·ç«¯
    

### [](#p-6762283-see_no_evil_monkey-6)![](https://linux.do/images/emoji/twemoji/see_no_evil_monkey.png?v=14)
 ä½¿ç”¨æ–¹æ³•

#### [](#p-6762283-h-1-cloudflare-workers-7)1\. éƒ¨ç½²åˆ° Cloudflare Workersï¼ˆæ¨èï¼‰

```


`# åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ gem.jsï¼ŒæŠŠä»£ç ç²˜è´´è¿›å»

# ç„¶åä¸€é”®éƒ¨ç½²

wrangler deploy gem.js` 
```

éƒ¨ç½²å®Œæˆåï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªç½‘å€ï¼Œæ¯”å¦‚ï¼š`https://gem.yourname.workers.dev`

#### [](#p-6762283-h-2-8)2\. æœ¬åœ°æµ‹è¯•

å¦‚æœä½ è£…äº† Denoï¼Œå¯ä»¥ç›´æ¥è¿è¡Œï¼š

```


`deno run --allow-net gem.js` 
```

#### [](#p-6762283-h-3-9)3\. ä¿®æ”¹ä½ çš„ä»£ç 

åªéœ€è¦æŠŠè¯·æ±‚åœ°å€æ”¹ä¸€ä¸‹å°±è¡Œï¼š

```


`// ä¹‹å‰ï¼šç›´æ¥è¯·æ±‚ Google

const url = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:streamGenerateContent';

// ç°åœ¨ï¼šé€šè¿‡ä¸­é—´ä»¶

const url = 'https://gem.yourname.workers.dev/v1beta/models/gemini-pro:streamGenerateContent';

// å…¶ä½™ä»£ç æ— éœ€ä¿®æ”¹` 
```

### [](#p-6762283-bullseye-10)![](https://linux.do/images/emoji/twemoji/bullseye.png?v=14)
 å®é™…æ•ˆæœ

ä½¿ç”¨å‰ï¼š

```


`User: å†™ä¸€ç¯‡å…³äº çŒç¡ä¹” çš„æ–‡ç« ï¼Œ5000å­—

Gemini: â€œçŒç¡ä¹”â€è¿™ä¸€æ ‡ç­¾çš„æ„æ€å ªç§°â€œç²¾å‡†æ‰“å‡»â€ã€‚å®ƒé¦–æ¬¡å¤§è§„æ¨¡å‡ºç°äº2019å¹´ï¼Œå½“æ—¶æ‹œç™»...

[å†™åˆ° 1000 å­—çªç„¶æˆªæ–­ï¼Œè¿”å› SAFETY]` 
```

ä½¿ç”¨åï¼š

```


`User: å†™ä¸€ç¯‡å…³äº çŒç¡ä¹” çš„æ–‡ç« ï¼Œ5000å­—

Gemini: â€œçŒç¡ä¹”â€è¿™ä¸€æ ‡ç­¾çš„æ„æ€å ªç§°â€œç²¾å‡†æ‰“å‡»â€ã€‚å®ƒé¦–æ¬¡å¤§è§„æ¨¡å‡ºç°äº2019å¹´ï¼Œå½“æ—¶æ‹œç™»...

[1000å­—...è‡ªåŠ¨ç»­æ¥...3000å­—...ç»§ç»­...å®Œæ•´çš„5000å­—æ–‡ç« ]` 
```

### [](#p-6762283-thought_balloon-faq-11)![](https://linux.do/images/emoji/twemoji/thought_balloon.png?v=14)
 FAQ

**Qï¼šè¿™ä¼šä¸ä¼šè®©æˆ‘çš„ API è´¦å•ç¿»å€ï¼Ÿ**

Aï¼šä¸ä¼šç¿»å€ï¼Œä½†input tokenç¡®å®ä¼šå¢åŠ ã€‚æ¯”å¦‚ç†è®ºä¸Šä¸€æ¬¡è¯·æ±‚èƒ½æå®šçš„é—®é¢˜ï¼Œç°åœ¨å¯èƒ½éœ€è¦ 2-3 æ¬¡çš„è¯·æ±‚é‡æ”¾ã€‚ä¸è¿‡æ¯”èµ·æ‰‹åŠ¨é‡è¯•ï¼Œè´¹é’±æ€»æ¯”è´¹äººæ¥çš„å¥½ã€‚

**Qï¼šç»­æ¥çš„åœ°æ–¹ä¼šä¸ä¼šå¾ˆç”Ÿç¡¬ï¼Ÿ**

Aï¼šæˆ‘æµ‹è¯•ä¸‹æ¥ï¼Œæ•ˆæœå‡ºå¥‡çš„å¥½ã€‚Gemini å¾ˆèªæ˜ï¼Œç»™å®ƒä¸€ä¸ª â€œcontinueâ€ æŒ‡ä»¤ï¼Œå®ƒå°±çŸ¥é“è¦æ¥ç€ä¸Šæ–‡ç»§ç»­å†™ã€‚å¶å°”å¯èƒ½ä¼šæœ‰ä¸€ä¸¤å¥è½»å¾®çš„é‡å¤ï¼Œä½†æ•´ä½“å¾ˆæµç•…ã€‚

**Qï¼šä¸ºä»€ä¹ˆä¸ç›´æ¥è®¾ç½®æ›´å¤§çš„ token é™åˆ¶ï¼Ÿ**

Aï¼šè¿™ä¸ªé—®é¢˜ä¸æ˜¯ token é™åˆ¶å¯¼è‡´çš„ã€‚æˆ‘è¯•è¿‡è®¾ç½® 30000 çš„é™åˆ¶ï¼Œè¯¥æ–­è¿˜æ˜¯æ–­ã€‚è¿™æ˜¯ Gemini å†…éƒ¨çš„å†…å®¹å®¡æŸ¥æœºåˆ¶åœ¨ä½œæ€ªã€‚

**Qï¼šæ”¯æŒ Claude æˆ– GPT å—ï¼Ÿ**

Aï¼šç›®å‰åªæ”¯æŒ Geminiã€‚ä¸è¿‡ä»£ç ç»“æ„å¾ˆæ¸…æ™°ï¼Œå¦‚æœä½ ç†Ÿæ‚‰å…¶ä»– API çš„æ ¼å¼ï¼Œæ”¹æ”¹åº”è¯¥ä¹Ÿèƒ½ç”¨ã€‚

**Qï¼šä¼šä¸ä¼šè¿›å…¥æ­»å¾ªç¯ä¸€ç›´é‡è¯•ï¼Ÿ**

Aï¼šä¸ä¼šã€‚é»˜è®¤æœ€å¤šé‡è¯• 5 æ¬¡ï¼Œè¶…è¿‡å°±æŠ¥é”™ã€‚ä½ å¯ä»¥é€šè¿‡ `max_consecutive_failures` è°ƒæ•´è¿™ä¸ªæ•°å­—ã€‚

**Qï¼šå¦‚æœç»è¿‡è‡ªåŠ¨é‡è¯•åè¿˜æ˜¯æˆªæ–­è¯´æ˜ä»€ä¹ˆï¼Ÿ**

Aï¼š**è¯´æ˜ä½ çš„è¾“å…¥å·²ç»çªç ´äº† Gemini çš„å¿ƒç†é˜²çº¿ï¼Œè®©å®ƒè§‰å¾—"è¿™æ´»å„¿æˆ‘æ˜¯çœŸå¹²ä¸äº†"ã€‚è¿™æ—¶å€™è¿‡æ»¤å™¨ä¸å…‰æ‚å˜´ï¼Œè¿çœ¼ç›éƒ½ç»™è’™ä¸Šäº†**ï¼Œç›´æ¥è¿›å…¥"æˆ‘ä»€ä¹ˆéƒ½æ²¡çœ‹è§"æ¨¡å¼ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå»ºè®®æ¢ä¸ªè¯´æ³•é‡æ–°æ¥è¿‡â€”â€”è¦çŸ¥é“ï¼Œèƒ½è®© Gemini è¿™ä¹ˆåšå†³åœ°ç½¢å·¥ï¼Œä½ çš„è¾“å…¥ä¸€å®šæ˜¯è§¦ç¢°åˆ°äº†å®ƒä¼—æ‰€å‘¨çŸ¥çš„"é€†é³"ã€‚

### [](#p-6762283-jellyfish-12)![](https://linux.do/images/emoji/twemoji/jellyfish.png?v=14)
 ä¸€äº›æœ‰è¶£çš„å‘ç°

1.  **å¼•ç”¨ç”Ÿæˆç‰¹åˆ«å®¹æ˜“è§¦å‘ä¸­æ–­**ï¼šå¯èƒ½æ˜¯å› ä¸ºå¼•ç”¨ç‰‡æ®µå®¹æ˜“åŒ¹é…åˆ°ç‰ˆæƒæ•°æ®
    
2.  **ä¸­æ–‡å†…å®¹æ¯”è‹±æ–‡æ›´å®¹æ˜“ä¸­æ–­**ï¼šåŸå› ä¸æ˜ï¼Œå¯èƒ½æ˜¯è®­ç»ƒæ•°æ®çš„é—®é¢˜
    
3.  **åˆ›æ„å†™ä½œæ¯”äº‹å®é™ˆè¿°æ›´æµç•…**ï¼š AI ä¹ŸçŸ¥é“"ç¼–æ•…äº‹"æ¯”"è®²çœŸè¯"æ›´å®‰å…¨ï¼
    

### [](#p-6762283-hourglass_done-13)![](https://linux.do/images/emoji/twemoji/hourglass_done.png?v=14)
 å†™åœ¨æœ€å

è¿™ä¸ªå·¥å…·åªæ˜¯ä¸€ä¸ª workaroundï¼Œä¹Ÿæœ‰å¾ˆå¤šå¯ä»¥æ”¹è¿›çš„åœ°æ–¹ï¼Œä½†æ˜¯ï¼å®ƒå±…ç„¶çœŸçš„èƒ½ç”¨æ¬¸ï¼

å¦‚æœä½ ä¹Ÿæ­£è¢«Geminiçš„æˆªæ–­å›°æ‰°ï¼Œä¸å¦¨è¯•è¯•è¿™ä¸ªæ–¹æ¡ˆã€‚æœ‰é—®é¢˜æ¬¢è¿äº¤æµï¼Œæœ‰æ”¹è¿›å»ºè®®æ›´æ¬¢è¿ PRï¼

ç¥å¤§å®¶ç”¨å¾—happyï¼Œä¹Ÿå¸Œæœ› Google å°½æ—©æ¾ç»‘ Geminiï¼Œè«è¦è³è‡‚å½“è½¦

  

3 ä¸ªå›å¤

![](https://linux.do/images/emoji/twemoji/heart.png?v=14)

heart

![](https://linux.do/images/emoji/twemoji/+1.png?v=14)

+1

![](https://linux.do/images/emoji/twemoji/confetti_ball.png?v=14)

confetti\_ball

![](https://linux.do/images/emoji/twemoji/open_mouth.png?v=14)

open\_mouth

![](https://linux.do/uploads/default/original/3X/2/e/2e09f3a3c7b27eacbabe9e9614b06b88d5b06343.png?v=14)

tieba\_087

68

â€‹ â€‹ å›å¤

*   [![](https://linux.do/images/emoji/twemoji/ringed_planet.png?v=14)
    Lç«™ç¦åˆ©åŠé¡¹ç›®ä¿¡æ¯æ±‡æ€»ã€AIç¯‡ã€‘ï¼ˆä¸å®šæ—¶æ›´æ–°ï¼‰](https://linux.do/t/topic/742212)
    

743 æµè§ˆé‡ 106 èµ 3 é“¾æ¥ 28 ç”¨æˆ·

 [![](https://linux.do/user_avatar/linux.do/0v0/96/46947_2.png)
 8](/u/0v0 "0v0") 

 [![](https://linux.do/user_avatar/linux.do/flowsong/96/765092_2.png)
 3](/u/flowsong "flowsong") 

 [![](https://linux.do/user_avatar/linux.do/gfsienx/96/79014_2.png)
 2](/u/gfsienx "gfsienx") 

 [![](https://linux.do/user_avatar/linux.do/snaily/96/611992_2.png)](/u/snaily "snaily") 

 [![](https://linux.do/user_avatar/linux.do/jyrealmadrid/96/55321_2.png)](/u/jyrealmadrid "jyrealmadrid") 

é˜…è¯»æ—¶é—´ 6 åˆ†é’Ÿ

[![](https://linux.do/user_avatar/linux.do/reno/96/535005_2.png)
](/u/Reno)

[Reno](/u/Reno)

ğŸ¦â€ğŸ”¥ æµ´ç«é‡ç”Ÿ

[1 å¤©](/t/topic/741953/2?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

å¤ªå¼ºäº† ![](https://linux.do/images/emoji/twemoji/heart_eyes.png?v=14)

  

![](https://linux.do/images/emoji/twemoji/heart.png?v=14)

heart

![](https://linux.do/uploads/default/original/3X/2/e/2e09f3a3c7b27eacbabe9e9614b06b88d5b06343.png?v=14)

tieba\_087

3

â€‹ â€‹ å›å¤

[![](https://linux.do/user_avatar/linux.do/qiner/96/555665_2.png)
](/u/Qiner)

[æ—é»›ç‰å€’æ‹”å‚æ¨æŸ³](/u/Qiner)

[Qiner](/u/Qiner)æ— æ‰€ä¸çŸ¥

[1 å¤©](/t/topic/741953/3?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

é‚“ï¼ç´«ï¼æ£‹ï¼

  

2 ä¸ªå›å¤

![](https://linux.do/images/emoji/twemoji/heart.png?v=14)

heart

![](https://linux.do/images/emoji/twemoji/laughing.png?v=14)

laughing

9

â€‹ â€‹ å›å¤

[![](https://linux.do/user_avatar/linux.do/xdx-pp/96/634573_2.png)
](/u/XDX-pp)

[å°æ®¿ä¸‹](/u/XDX-pp)

[XDX-pp](/u/XDX-pp)æ–‡åŒ–å®£å¯¼å‘˜ ![](https://linux.do/uploads/default/original/3X/9/e/9e07307cddc9a8e1b17374d688dcd9cac0009b36.png?v=14) 

[1 å¤©](/t/topic/741953/4?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

tqltql

  

1

â€‹ â€‹ å›å¤

[![](https://linux.do/user_avatar/linux.do/tttt1/96/274498_2.png)
](/u/tttt1)

[tttt1](/u/tttt1)

æµ·çº³ç™¾å· ![](https://linux.do/images/emoji/twemoji/grinning.png?v=14) 

[1 å¤©](/t/topic/741953/5?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

å¤ªå¼ºäº†ï¼

  

1

â€‹ â€‹ å›å¤

[![](https://linux.do/user_avatar/linux.do/handsome/96/736205_2.png)
](/u/handsome)

[å¤§å¸…å“¥](/u/handsome)

[handsome](/u/handsome)ç§å­ç”¨æˆ· ![](https://linux.do/images/emoji/twemoji/rage.png?v=14) 

[1 å¤©](/t/topic/741953/6?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

ä½ ä¹Ÿå¤ªå¼ºäº†ï¼

  

1

â€‹ â€‹ å›å¤

[![](https://linux.do/user_avatar/linux.do/yqyan/96/576335_2.png)
](/u/yqyan)

[Grogu](/u/yqyan)

[yqyan](/u/yqyan)

[1 å¤©](/t/topic/741953/7?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

ä½¬å‹å¤ªå¼ºäº† ![](https://linux.do/images/emoji/twemoji/+1.png?v=14)

  

1

â€‹ â€‹ å›å¤

[![](https://linux.do/letter_avatar/skyfox/96/5_d44a9b381edc88181525e3c8350177ca.png)
](/u/skyfox)

[skyfox](/u/skyfox)

[1 å¤©](/t/topic/741953/8?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

å¼ºå¼ºå¼ºï¼Œè™½ç„¶ä¸æ‡‚

  

1

â€‹ â€‹ å›å¤

[![](https://linux.do/user_avatar/linux.do/tut/96/351556_2.png)
](/u/TuT)

[(à¹‘ï¼›á´— ;)ï»­](/u/TuT)

[TuT](/u/TuT) ![](https://linux.do/uploads/default/original/3X/1/2/12760392cf794919281976e6bd5a3be36490b8ab.png?v=14) 

[1 å¤©](/t/topic/741953/9?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

![](https://linux.do/user_avatar/linux.do/0v0/48/46947_2.png)
 0v0:

> ç”œèœè¿‡æ»¤å™¨å°±ä¼šä½“è´´åœ°å¸®ä½ æ‚ä¸ŠGeminiçš„å˜´

![](https://linux.do/uploads/default/original/3X/2/1/21158038759f6a8630df8507f782a45a6caee004.png?v=14)
 æ˜¯å¾ˆé«˜æ•ˆäº† ![](https://linux.do/uploads/default/original/3X/e/7/e795be81708bb078edbd3b237c7c58b0190911c3.png?v=14)

  

![](https://linux.do/images/emoji/twemoji/laughing.png?v=14)

laughing

![](https://linux.do/images/emoji/twemoji/heart.png?v=14)

heart

3

â€‹ â€‹ å›å¤

[![](https://linux.do/user_avatar/linux.do/elfmaid/96/656644_2.png)
](/u/elfmaid)

[Elf](/u/elfmaid)

[elfmaid](/u/elfmaid)æŒ‡å¯¼é¡¾é—®

[1 å¤©](/t/topic/741953/10?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

å¤ªå¼ºäº†å•Š

  

![](https://linux.do/images/emoji/twemoji/heart.png?v=14)

heart

![](https://linux.do/uploads/default/original/3X/2/e/2e09f3a3c7b27eacbabe9e9614b06b88d5b06343.png?v=14)

tieba\_087

3

â€‹ â€‹ å›å¤

[![](https://linux.do/user_avatar/linux.do/snaily/96/611992_2.png)
](/u/snaily)

[snaily](/u/snaily)

å¤§é¢„è¨€å®¶ ![](https://linux.do/images/emoji/twemoji/cn.png?v=14) 

[1 å¤©](/t/topic/741953/11?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

å¤ªå¼ºäº†ç”œèœovoä½¬ ![](https://linux.do/uploads/default/original/3X/2/e/2e09f3a3c7b27eacbabe9e9614b06b88d5b06343.png?v=14)

  

1 ä¸ªå›å¤

![](https://linux.do/images/emoji/twemoji/heart.png?v=14)

heart

![](https://linux.do/uploads/default/original/3X/2/e/2e09f3a3c7b27eacbabe9e9614b06b88d5b06343.png?v=14)

tieba\_087

2

â€‹ â€‹ å›å¤

[![](https://linux.do/user_avatar/linux.do/0v0/96/46947_2.png)
](/u/0v0)

[0v0](/u/0v0)

 ![](https://linux.do/user_avatar/linux.do/qiner/48/555665_2.png)
 æ—é»›ç‰å€’æ‹”å‚æ¨æŸ³

[1 å¤©](/t/topic/741953/12?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

GEMå§ä½ è¯´è¯æ€ä¹ˆç»“ç»“å·´å·´çš„ï¼Œæ˜¯ä¸æ˜¯ä¸Šç«äº†å—·~

  

![](https://linux.do/images/emoji/twemoji/laughing.png?v=14)

laughing

2

â€‹ â€‹ å›å¤

[![](https://linux.do/letter_avatar/pluto233/96/5_d44a9b381edc88181525e3c8350177ca.png)
](/u/pluto233)

[pluto233](/u/pluto233)

[1 å¤©](/t/topic/741953/13?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

å¤©æ‰å–µ  
æœ‰ä¸ªé—®é¢˜æƒ³çŸ¥é“ éš¾é“ç»§ç»­çš„è¯å®¡æ ¸æ¨¡å‹æ˜¯è¿‡ä¸€ä¼šæ‰å¯åŠ¨å—  
ä¸ºä»€ä¹ˆä¸ä¼šä¸€ç›´æ‚å˜´å–µ

  

2 ä¸ªå›å¤

1

â€‹ â€‹ å›å¤

[![](https://linux.do/user_avatar/linux.do/verel/96/553201_2.png)
](/u/Verel)

[verel](/u/Verel)

ä¸€å…ƒå¤å§‹

[1 å¤©](/t/topic/741953/14?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

å¯ä»¥æ”¯æŒé‚£ç§ä¹‹å‰è¯·æ±‚çš„åœ°å€æ¢æˆè‡ªå®šä¹‰çš„å—ä½¬

  

â€‹ â€‹ å›å¤

[![](https://linux.do/letter_avatar/lylinuxdo2/96/5_d44a9b381edc88181525e3c8350177ca.png)
](/u/lylinuxdo2)

[lylinuxdo2](/u/lylinuxdo2)

æ–‡åŒ–å®£å¯¼å‘˜

[1 å¤©](/t/topic/741953/15?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

6å…ˆmarkä¸€ä¸‹ è¿˜æœ‰çœ‹æ ·å­Googleçš„å¯çœŸçš„æ˜¯ç”œèœä¸ºä»€ä¹ˆä¸æœ‰ä»€ä¹ˆæ•æ„Ÿçš„ç›´æ¥ä½¿ç”¨â–ˆâ–ˆâ–ˆâ–ˆæ¥è¾“å‡ºå‘¢ ![](https://linux.do/images/emoji/twemoji/laughing.png?v=14)

  

â€‹ â€‹ å›å¤

[![](https://linux.do/user_avatar/linux.do/slashkkk/96/767298_2.png)
](/u/slashkkk)

[ç©ºæ°”åŠ¨åŠ›å­¦](/u/slashkkk)

[slashkkk](/u/slashkkk)æŒ‡å¯¼é¡¾é—® ![](https://linux.do/uploads/default/original/3X/4/9/49b2eba636dba687d98c4254bb00c682194f3556.png?v=14) 

[1 å¤©](/t/topic/741953/16?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

è¯·æ•™ä¸ªé—®é¢˜ï¼šä»…ä»è´¨é‡ä¸Šæ¯”è¾ƒï¼Œå¦‚å¸–é‡‡ç”¨gemini api è¿›è¡Œæ£€ç´¢åˆ†æï¼Œæ¯”èµ· gemini deepresearch æœ‰ä½•åŒºåˆ«ã€æˆ–è€…ä¼˜åŠ¿ï¼Ÿ

  

1 ä¸ªå›å¤

â€‹ â€‹ å›å¤

[![](https://linux.do/user_avatar/linux.do/henrylol/96/295285_2.png)
](/u/Henrylol)

[Henrylol](/u/Henrylol)

æ´»è·ƒç”¨æˆ·

[1 å¤©](/t/topic/741953/17?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

![](https://linux.do/user_avatar/linux.do/0v0/48/46947_2.png)
 0v0:

> G.E.M.

G.E.M.ï¼ï¼

  

â€‹ â€‹ å›å¤

[![](https://linux.do/user_avatar/linux.do/flowsong/96/765092_2.png)
](/u/flowsong)

[Zwin'ImLuKa](/u/flowsong)

[flowsong](/u/flowsong) ![](https://linux.do/images/emoji/twemoji/heart.png?v=14) 

[1 å¤©](/t/topic/741953/18?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

è¿™èƒ½ç»­è‡ªå®šä¹‰çš„æ€ç»´é“¾å— ![](https://linux.do/images/emoji/twemoji/thinking.png?v=14)

  

1 ä¸ªå›å¤

1

â€‹ â€‹ å›å¤

[![](https://linux.do/user_avatar/linux.do/flowsong/96/765092_2.png)
](/u/flowsong)

[Zwin'ImLuKa](/u/flowsong)

[flowsong](/u/flowsong) ![](https://linux.do/images/emoji/twemoji/heart.png?v=14) 

 ![](https://linux.do/letter_avatar/pluto233/48/5_d44a9b381edc88181525e3c8350177ca.png)
 pluto233

[1 å¤©](/t/topic/741953/19?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

å¥½åƒæ˜¯æœ‰æ¦‚ç‡æ‚å˜´çš„

  

â€‹ â€‹ å›å¤

[![](https://linux.do/user_avatar/linux.do/supernova/96/749009_2.png)
](/u/Supernova)

[Supernova](/u/Supernova)

[1 å¤©](/t/topic/741953/20?u=niyan2025 "å‘å¸ƒæ—¥æœŸ")

è¦æ˜¯æœ‰dockerç‰ˆå°±å¥½äº†ï¼Œæˆ‘æœ‰ç‚¹æ€•CFçš„IPè·³æ¥è·³å»å®¹æ˜“è¢«è°·æ­Œå°å·ã€‚

  

1 ä¸ªå›å¤

â€‹ â€‹ å›å¤

Invalid date Invalid date

Settings
========

ğŸ·ï¸ UTags - Add usertags to links

Other Extensions
----------------

[ğŸ”— Links Helper](https://greasyfork.org/en/scripts/464541-links-helper)

[V2EX.REP - ä¸“æ³¨æå‡ V2EX ä¸»é¢˜å›å¤æµè§ˆä½“éªŒ](https://greasyfork.org/en/scripts/466589-v2ex-rep-%E4%B8%93%E6%B3%A8%E6%8F%90%E5%8D%87-v2ex-%E4%B8%BB%E9%A2%98%E5%9B%9E%E5%A4%8D%E6%B5%8F%E8%A7%88%E4%BD%93%E9%AA%8C)

[v2ex.min - V2EX Minimalist (æç®€é£æ ¼)](https://greasyfork.org/en/scripts/463552-v2ex-min-v2ex-%E6%9E%81%E7%AE%80%E9%A3%8E%E6%A0%BC)

[Replace Ugly Avatars](https://greasyfork.org/en/scripts/472616-replace-ugly-avatars)

â†‘â†“â‡”â‡§â‡©